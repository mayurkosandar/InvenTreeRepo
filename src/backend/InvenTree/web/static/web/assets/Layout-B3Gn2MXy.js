import{bY as it,bZ as ot,b_ as rt,b$ as at,c0 as O,c1 as P,j as e,c2 as lt,V as ae,B as ee,r as g,c3 as Le,z as De,c4 as ct,c5 as dt,E as ut,c6 as ht,y as pt,c7 as gt,c8 as ft,c9 as mt,ca as xt,cb as St,i as c,b1 as $,cc as jt,cd as _t,ce as ne,bz as N,bn as yt,cf as bt,cg as kt,ch as b,G as E,m as T,ci as wt,cj as vt,ck as At,aK as Te,cl as Et,cm as Ct,aJ as It,cn as Rt,S as q,bB as ie,co as Nt,by as U,A as je,cp as _e,u as Vt,cq as Oe,bE as M,l as ye,bA as be,cr as Pe,cs as zt,bG as Se,C as He,L as Me,J as Ue,ct as Lt,bT as Dt,cu as oe,cv as Tt,ax as Ot,cw as Re,cx as Pt,aw as Ht,cy as Mt,aI as Ut,bH as fe}from"./vendor-BnaqX2_l.js";import{u as We,a as H,v as me,k as Wt,l as Be,m as A,U as y,d as J,e as X,A as Y,f as Bt,b as Qt,M as Qe,n as $t,o as Ft}from"./index-fPzgLVil.js";import{d as qt,a as Zt,s as Kt,l as Gt,D as Jt,A as Xt,n as Ne}from"./links-63IpDbCn.js";import{o as Yt,l as es,k as ts,d as W,n as ss,T as D,S as ke,I as Ve,p as ns,q as $e,r as we,t as is,v as os,w as rs,x as as,y as ls,z as cs,b as Fe,O as ds,j as us}from"./BaseContext-CH9A7-TB.js";import{n as se}from"./navigation-B-mN4luC.js";import{L as xe,N as hs}from"./DesktopAppView-CAvOv5f4.js";import{u as ps}from"./UseInstanceName-fpzWThtG.js";import{R as gs}from"./Instance-DrUTN1gu.js";import"./ApiIcon-Bqf-O7I2.js";const fs=()=>ot({opened:!1,empty:!1,selected:-1,listId:"",query:"",registeredActions:new Set}),ms=t=>it(t);function Z(t,s){const n=s.getState();s.setState({...n,...t(s.getState())})}function qe(t){Z(()=>({opened:!0,selected:-1}),t)}function Ze(t){Z(()=>({opened:!1}),t)}function Ke(t){Z(s=>({opened:!s.opened}),t)}function Ge(t,s){s.updateState(n=>({...n,selected:t}))}function xs(t,s){s.updateState(n=>({...n,listId:t}))}function re(t,s=document){const n=s.querySelector(t);if(n)return n;const o=s instanceof ShadowRoot?s.host.children:s.children;for(let r=0;r<o.length;r+=1){const i=o[r];if(i.shadowRoot){const u=re(t,i.shadowRoot);if(u)return u}const d=re(t,i);if(d)return d}return null}function le(t,s){var f,a;const n=s.getState(),o=n.listId?re(`#${n.listId}`):null,r=o==null?void 0:o.querySelector("[data-selected]"),i=(o==null?void 0:o.querySelectorAll("[data-action]"))??[],d=t===-1?i.length-1:t===i.length?0:t,u=rt(d,0,i.length-1);return r==null||r.removeAttribute("data-selected"),(f=i[u])==null||f.scrollIntoView({block:"nearest"}),(a=i[u])==null||a.setAttribute("data-selected","true"),Ge(u,s),u}function Ss(t){return le(t.getState().selected+1,t)}function js(t){return le(t.getState().selected-1,t)}function _s(t){const s=t.getState(),n=re(`#${s.listId} [data-selected]`);n==null||n.click()}function ys(t,s){const n=s.getState();return n.registeredActions.add(t),()=>{n.registeredActions.delete(t)}}function bs(t,s){Z(()=>({query:t}),s),Promise.resolve().then(()=>{le(0,s),Z(n=>({empty:n.query.trim().length>0&&n.registeredActions.size===0||!1}),s)})}function ks({clearQuery:t},s){s.updateState(n=>({...n,selected:-1,query:t?"":n.query,empty:t?!1:n.empty}))}const z={open:qe,close:Ze,toggle:Ke,updateState:Z,setSelectedAction:Ge,setListId:xs,selectAction:le,selectNextAction:Ss,selectPreviousAction:js,triggerSelectedAction:_s,registerAction:ys,setQuery:bs,clearSpotlightState:ks};function Je(){const t=fs();return[t,{open:()=>qe(t),close:()=>Ze(t),toggle:()=>Ke(t)}]}const[Xe,ve]=Je();function Ye(t){const s=t;return s.group!==void 0&&Array.isArray(s.actions)}function ws(t){return Array.isArray(t)?t.map(s=>s.trim()).join(",").toLowerCase().trim():typeof t=="string"?t.toLowerCase().trim():""}function vs(t){return t.reduce((s,n)=>"actions"in n?[...s,...n.actions.map(o=>({...o,group:n.group}))]:[...s,n],[])}function As(t){const s={},n=[];return t.forEach(o=>{o.group?(s[o.group]||(s[o.group]={pushed:!1,data:{group:o.group,actions:[]}}),s[o.group].data.actions.push(o),s[o.group].pushed||(s[o.group].pushed=!0,n.push(s[o.group].data))):n.push(o)}),n}const Es=(t,s)=>{const n=t.trim().toLowerCase(),o=[[],[]];return vs(s).forEach(i=>{var d,u;(d=i.label)!=null&&d.toLowerCase().includes(n)?o[0].push(i):((u=i.description)!=null&&u.toLowerCase().includes(n)||ws(i.keywords).includes(n))&&o[1].push(i)}),As(o.flat())};function et(t,s){if(!Array.isArray(t))return[];let n=0;return t.reduce((o,r)=>{if(n>=s)return o;if(Ye(r)){const i=et(r.actions,s-n);o.push({group:r.group,actions:i}),n+=i.length}else o.push(r),n+=1;return o},[])}const[Cs,K]=at("Spotlight component was not found in tree");var L={root:"m_d2b315db",content:"m_3cd250e0",body:"m_d2abce9b",search:"m_f366a061",actionsList:"m_6e463822",action:"m_d49bb8ef",actionBody:"m_3d475731",actionSection:"m_832642f6",actionLabel:"m_6c2a1345",actionDescription:"m_a6d9d78d",empty:"m_82f78f74",footer:"m_ddcaf054",actionsGroup:"m_5a3e5f7b"};const Is={dimmedSections:!0,highlightQuery:!1},te=O((t,s)=>{const n=P("SpotlightAction",Is,t),{className:o,style:r,classNames:i,styles:d,id:u,description:f,label:a,leftSection:l,rightSection:j,children:S,dimmedSections:k,highlightQuery:h,highlightColor:w,closeSpotlightOnTrigger:v,onClick:I,onMouseDown:_,keywords:B,vars:Q,...m}=n,p=K(),x={classNames:i,styles:d},R=h&&typeof a=="string"?e.jsx(lt,{component:"span",highlight:p.query,color:w,...p.getStyles("actionLabel",x),children:a}):e.jsx("span",{...p.getStyles("actionLabel",x),children:a});return e.jsx(ae,{ref:s,"data-action":!0,...p.getStyles("action",{className:o,style:r,...x}),...m,onMouseDown:V=>{V.preventDefault(),_==null||_(V)},onClick:V=>{I==null||I(V),(v??p.closeOnActionTrigger)&&z.close(p.store)},tabIndex:-1,children:S||e.jsxs(e.Fragment,{children:[l&&e.jsx(ee,{component:"span",mod:{position:"left",dimmed:k},...p.getStyles("actionSection",x),children:l}),e.jsxs("span",{...p.getStyles("actionBody",x),children:[R,e.jsx("span",{...p.getStyles("actionDescription",x),children:f})]}),j&&e.jsx(ee,{component:"span",mod:{position:"right",dimmed:k},...p.getStyles("actionSection",x),children:j})]})})});te.classes=L;te.displayName="@mantine/spotlight/SpotlightAction";const Rs={},ce=O((t,s)=>{const{className:n,style:o,styles:r,classNames:i,label:d,children:u,...f}=P("SpotlightActionsGroup",Rs,t),a=K();return e.jsx(ee,{...a.getStyles("actionsGroup",{className:n,style:o,classNames:i,styles:r}),ref:s,...f,__vars:{"--spotlight-label":`'${d}'`},children:u})});ce.classes=L;ce.displayName="@mantine/core/SpotlightActionsGroup";const Ns={},de=O((t,s)=>{const{className:n,style:o,id:r,children:i,vars:d,classNames:u,styles:f,...a}=P("SpotlightActionsList",Ns,t),l=K(),j=`mantine-${g.useId().replace(/:/g,"")}`,S=r||j;return g.useEffect(()=>(z.setListId(S,l.store),()=>z.setListId("",l.store)),[]),e.jsx(Le.Autosize,{...l.getStyles("actionsList",{className:n,style:o,classNames:u,styles:f}),ref:s,type:"scroll",scrollbarSize:"var(--spotlight-actions-list-padding)",offsetScrollbars:"y",id:S,...a,children:i})});de.classes=L;de.displayName="@mantine/spotlight/SpotlightActionsList";const Vs={},ue=O((t,s)=>{const{className:n,style:o,classNames:r,styles:i,...d}=P("SpotlightEmpty",Vs,t),u=K();return e.jsx(ee,{ref:s,...u.getStyles("empty",{classNames:r,styles:i,className:n,style:o}),...d})});ue.classes=L;ue.displayName="@mantine/spotlight/SpotlightEmpty";const zs={},Ae=O((t,s)=>{const{className:n,style:o,classNames:r,styles:i,...d}=P("SpotlightFooter",zs,t),u=K();return e.jsx(ee,{ref:s,...u.getStyles("footer",{className:n,classNames:r,style:o,styles:i}),...d})});Ae.classes=L;Ae.displayName="@mantine/spotlight/SpotlightFooter";function Ls(t,s){if(!t)return[];const n=()=>z.open(s);return Array.isArray(t)?t.map(o=>[o,n]):[[t,n]]}const Ds={size:600,yOffset:80,zIndex:De("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:Xe,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K",maxHeight:400,scrollable:!1},he=O((t,s)=>{const n=P("SpotlightRoot",Ds,t),{classNames:o,className:r,style:i,styles:d,unstyled:u,vars:f,store:a,children:l,query:j,onQueryChange:S,transitionProps:k,clearQueryOnClose:h,shortcut:w,tagsToIgnore:v,triggerOnContentEditable:I,disabled:_,onSpotlightOpen:B,onSpotlightClose:Q,forceOpened:m,closeOnActionTrigger:p,maxHeight:x,scrollable:R,...V}=n,Ce=ct(),{opened:ge,query:tt}=ms(a),st=j||tt,Ie=G=>{S==null||S(G),z.setQuery(G,a)},nt=dt({name:"Spotlight",classes:L,props:n,className:r,style:i,classNames:o,styles:d,unstyled:u});return ut(Ls(w,a),v,I),ht(()=>{ge?B==null||B():Q==null||Q()},[ge]),_?null:e.jsx(Cs,{value:{getStyles:nt,query:st,setQuery:Ie,store:a,closeOnActionTrigger:p},children:e.jsx(pt,{ref:s,...V,withCloseButton:!1,opened:ge||!!m,padding:0,onClose:()=>z.close(a),className:r,style:i,classNames:gt({theme:Ce,classNames:[L,o],props:n,stylesCtx:void 0}),styles:ft({theme:Ce,styles:d,props:n,stylesCtx:void 0}),transitionProps:{...k,onExited:()=>{var G;h&&Ie(""),z.clearSpotlightState({clearQuery:h},a),(G=k==null?void 0:k.onExited)==null||G.call(k)}},__vars:{"--spotlight-max-height":R?mt(x):void 0},__staticSelector:"Spotlight","data-scrollable":R||void 0,children:l})})});he.classes=L;he.displayName="@mantine/spotlight/SpotlightRoot";const Ts={size:"lg"},pe=O((t,s)=>{const{classNames:n,styles:o,onKeyDown:r,onChange:i,vars:d,value:u,...f}=P("SpotlightSearch",Ts,t),a=K(),l=a.getStyles("search"),[j,S]=g.useState(!1),k=h=>{r==null||r(h),!j&&(h.nativeEvent.code==="ArrowDown"&&(h.preventDefault(),z.selectNextAction(a.store)),h.nativeEvent.code==="ArrowUp"&&(h.preventDefault(),z.selectPreviousAction(a.store)),(h.nativeEvent.code==="Enter"||h.nativeEvent.code==="NumpadEnter")&&(h.preventDefault(),z.triggerSelectedAction(a.store)))};return e.jsx(xt,{ref:s,classNames:[{input:l.className},n],styles:[{input:l.style},o],...f,value:u??a.query,onChange:h=>{a.setQuery(h.currentTarget.value),i==null||i(h)},onKeyDown:k,onCompositionStart:()=>S(!0),onCompositionEnd:()=>S(!1)})});pe.classes=L;pe.displayName="@mantine/spotlight/SpotlightSearch";const Os={size:600,yOffset:80,limit:1/0,zIndex:De("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:Xe,filter:Es,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K",highlightQuery:!1},C=O((t,s)=>{const n=P("Spotlight",Os,t),{searchProps:o,filter:r,query:i,onQueryChange:d,actions:u,nothingFound:f,highlightQuery:a,limit:l,...j}=n,[S,k]=St({value:i,defaultValue:"",finalValue:"",onChange:d}),h=et(r(S,u),l).map(w=>{if(Ye(w)){const v=w.actions.map(({id:I,..._})=>e.jsx(te,{highlightQuery:a,..._},I));return e.jsx(ce,{label:w.group,children:v},w.group)}return e.jsx(te,{highlightQuery:a,...w},w.id)});return e.jsxs(he,{...j,query:S,onQueryChange:k,ref:s,children:[e.jsx(pe,{...o}),e.jsxs(de,{children:[h,h.length===0&&f&&e.jsx(ue,{children:f})]})]})});C.classes=L;C.displayName="@mantine/spotlight/Spotlight";C.Search=pe;C.ActionsList=de;C.Action=te;C.Empty=ue;C.ActionsGroup=ce;C.Footer=Ae;C.Root=he;C.open=ve.open;C.close=ve.close;C.toggle=ve.toggle;function Ps(t){return Yt({modal:"qr",innerProps:{navigate:t}})}function Hs(t){const s=We(r=>r.setNavigationOpen),{user:n}=H(),o=[{id:"dashboard",label:c._({id:"7p5kLi"}),description:c._({id:"kwda2l"}),onClick:()=>{},leftSection:e.jsx($,{size:"1.2rem"})},{id:"documentation",label:c._({id:"TvY/XA"}),description:c._({id:"hqbo9J"}),onClick:()=>{window.location.href=qt.faq},leftSection:e.jsx($,{size:"1.2rem"})},{id:"about",label:c._({id:"iDxamh"}),description:c._({id:"gfhzPz"}),onClick:()=>Zt(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"server-info",label:c._({id:"mHGdhG"}),description:c._({id:"Ckl0UI"}),onClick:()=>Kt(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"license-info",label:c._({id:"I/Xnkt"}),description:c._({id:"L23uA9"}),onClick:()=>Gt(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"navigation",label:c._({id:"rmlxV1"}),description:c._({id:"xIiHCw"}),onClick:()=>s(!0),leftSection:e.jsx(jt,{size:"1.2rem"})},{id:"scan",label:c._({id:"I+FvbD"}),description:c._({id:"9j/kJy"}),onClick:()=>Ps(t),leftSection:e.jsx(_t,{size:"1.2rem"})}];return n!=null&&n.is_staff&&o.push({id:"admin-center",label:c._({id:"uTLn08"}),description:c._({id:"txYotp"}),onClick:()=>{},leftSection:e.jsx($,{size:"1.2rem"})}),o}function Ms(){return e.jsx("div",{className:es})}function Us(){const[t,{open:s,close:n}]=ne(!1);return e.jsxs(e.Fragment,{children:[e.jsx(N,{onClick:s,variant:"transparent",title:c._({id:"YzRRV6"}),children:e.jsx(yt,{})}),e.jsx(ts,{opened:t,onClose:n})]})}function Ws(){return e.jsx(N,{onClick:()=>sn.open(),title:c._({id:"FcOU0s"}),variant:"transparent","aria-label":"open-spotlight",children:e.jsx(bt,{})})}function Bs(){const t=W(),[s,n]=H(i=>[i.user,i.username]),{colorScheme:o,toggleColorScheme:r}=kt();return e.jsxs(b,{width:260,position:"bottom-end",children:[e.jsx(b.Target,{children:e.jsx(ae,{className:ss,children:e.jsxs(E,{gap:7,children:[n()?e.jsx(T,{fw:500,size:"sm",style:{lineHeight:1},mr:3,children:n()}):e.jsx(wt,{height:20,width:40,radius:me.radiusDefault}),e.jsx(vt,{})]})})}),e.jsxs(b.Dropdown,{children:[e.jsx(b.Label,{children:e.jsx(D,{id:"Tz0i8g"})}),e.jsx(b.Item,{leftSection:e.jsx(At,{}),component:xe,to:"/settings/user",children:e.jsx(D,{id:"Puv7+X"})}),(s==null?void 0:s.is_staff)&&e.jsx(b.Item,{leftSection:e.jsx(Te,{}),component:xe,to:"/settings/system",children:e.jsx(D,{id:"zNkWa6"})}),e.jsx(b.Item,{onClick:r,leftSection:o==="dark"?e.jsx(Et,{}):e.jsx(Ct,{}),c:o==="dark"?me.colors.yellow[4]:me.colors.blue[6],children:e.jsx(D,{id:"4i3x9F"})}),(s==null?void 0:s.is_staff)&&e.jsx(b.Divider,{}),(s==null?void 0:s.is_staff)&&e.jsx(b.Item,{leftSection:e.jsx(It,{}),component:xe,to:"/settings/admin",children:e.jsx(D,{id:"uTLn08"})}),e.jsx(b.Divider,{}),e.jsx(b.Item,{leftSection:e.jsx(Rt,{}),onClick:()=>{Wt(t)},children:e.jsx(D,{id:"nOhz3x"})})]})]})}const Qs="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='400'%3e%3cg%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%3e%3cpath%20fill='%23ddbc91'%20d='M200%20199.906v193.196l166.305-96.016V103.139Z'/%3e%3cpath%20fill='%23d9b383'%20d='M200%20199.906v193.196L33.695%20297.086V103.139Z'/%3e%3cpath%20fill='%23ddbc91'%20d='M366.305%20103.139%20200%20199.906%2033.695%20103.14%20200%206.899z'/%3e%3cg%20fill='%23f3f4e4'%3e%3cpath%20d='M75.27%20127.109v145.46L200%20344.583l124.73-72.012V127.109L200%20199.684Z'/%3e%3cpath%20d='M324.73%20127.11%20200%20199.684%2075.27%20127.109%20200%2054.93Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20d='M200%2054.929v144.756L75.27%20272.569V127.11z'/%3e%3cpath%20fill='%23eaeccf'%20d='M200%2054.929v144.756l124.73%2072.884V127.11z'/%3e%3cpath%20fill='%2390a8d8'%20d='M200%20199.901V296.5l83.153-48.008v-96.973zm0%200V296.5l-83.153-48.008v-96.973zm83.153-48.383L200%20199.9l-83.153-48.383L200%20103.398Z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20443.959v216.54l186.4-107.618V335.499Zm0%200v216.54l-186.4-107.618V335.499Z'/%3e%3cpath%20d='m-360.266%20335.499-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20227.419v216.54l186.4-107.619V118.96Zm0%200v216.54l-186.4-107.619V118.96Z'/%3e%3cpath%20d='m-360.266%20118.959-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667%2010.879v216.54l186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23d9b383'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%20d='M-546.667%2010.879v216.54l-186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='m-360.266-97.581-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3cg%20fill='%23f3f4e4'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.058'%3e%3cpath%20stroke-width='3'%20d='M-686.466-70.715V92.321l139.798%2080.714%20139.801-80.714V-70.715l-139.8%2081.346z'/%3e%3cpath%20stroke-width='2.999'%20d='m-406.866-70.715-139.8%2081.345-139.801-81.345%20139.8-80.902Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l-139.8%2081.692V-70.715z'/%3e%3cpath%20fill='%23eaeccf'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l139.8%2081.692V-70.715z'/%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.999'%3e%3cpath%20d='M-546.667%2010.873v108.27l93.2-53.81v-108.69zm0%200v108.27l-93.2-53.81v-108.69z'/%3e%3cpath%20d='m-453.466-43.357-93.2%2054.23-93.201-54.23%2093.2-53.935Z'/%3e%3c/g%3e%3cpath%20fill='none'%20d='M-787.948-253.366h482.56v946.733h-482.56z'/%3e%3c/svg%3e";g.forwardRef((t,s)=>e.jsx("div",{ref:s,...t,children:e.jsx(hs,{to:"/",children:e.jsx(N,{size:28,variant:"transparent",children:e.jsx(Ee,{})})})}));const Ee=()=>e.jsx("img",{src:Qs,alt:c._({id:"DVAy0b"}),height:28});function $s({openDrawer:t}){return e.jsx(ae,{onClick:()=>t(),"aria-label":"navigation-menu",children:e.jsx(Ee,{})})}function F({title:t,links:s,beforeClick:n}){const o=W(),r=g.useMemo(()=>s.filter(i=>!i.hidden),[s]);return r.length==0?null:e.jsx(e.Fragment,{children:e.jsxs(q,{gap:"xs",children:[e.jsx(ie,{}),e.jsx(ke,{size:"md",children:t}),e.jsx(ie,{}),e.jsx(Nt,{cols:2,spacing:0,p:3,children:r.map(i=>e.jsx(U,{label:i.description,hidden:!i.description,children:i.link&&i.external?e.jsx(je,{href:i.link,children:e.jsxs(E,{wrap:"nowrap",children:[i.external&&e.jsx(Ve,{icon:i.icon??"link",iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})}):e.jsx(ae,{onClick:d=>{i.link?(n==null||n(),se(i.link,o,d)):i.action&&(n==null||n(),i.action())},children:e.jsxs(E,{wrap:"nowrap",children:[i.icon&&e.jsx(Ve,{icon:i.icon,iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})})},`menu-link-tooltip-${i.id}`))})]})})}const ze=[];function Fs({opened:t,close:s}){return e.jsx(_e,{opened:t,onClose:s,size:"lg",withCloseButton:!1,classNames:{body:ns},children:e.jsx(qs,{closeFunc:s})})}function qs({closeFunc:t}){const s=H(),n=Be(),[o,r]=g.useState(0),i=g.useRef(null),{height:d}=Vt(),u=ps();g.useEffect(()=>{i.current!=null&&r(d-i.current.clientHeight-65)});const f=g.useMemo(()=>[{id:"home",title:c._({id:"7p5kLi"}),link:"/",icon:"dashboard"},{id:"parts",title:c._({id:"pmRbKZ"}),hidden:!s.hasViewPermission(A.part),link:"/part",icon:"part"},{id:"stock",title:c._({id:"blbbPS"}),link:"/stock",hidden:!s.hasViewPermission(A.stockitem),icon:"stock"},{id:"build",title:c._({id:"3ctapx"}),link:"/manufacturing/",hidden:!s.hasViewRole(y.build),icon:"build"},{id:"purchasing",title:c._({id:"UOTpFa"}),link:"/purchasing/",hidden:!s.hasViewRole(y.purchase_order),icon:"purchase_orders"},{id:"sales",title:c._({id:"mUv9U4"}),link:"/sales/",hidden:!s.hasViewRole(y.sales_order),icon:"sales_orders"}],[s]),a=g.useMemo(()=>[{id:"barcode",title:c._({id:"fNvDwV"}),link:"/scan",icon:"barcode",hidden:!n.isSet("BARCODE_ENABLE")}],[s,n]),l=g.useMemo(()=>[{id:"notifications",title:c._({id:"iDNBZe"}),link:"/notifications",icon:"notification"},{id:"user-settings",title:c._({id:"ekfzWq"}),link:"/settings/user",icon:"user"},{id:"system-settings",title:c._({id:"zNkWa6"}),link:"/settings/system",icon:"system",hidden:!s.isStaff()},{id:"admin-center",title:c._({id:"uTLn08"}),link:"/settings/admin",icon:"admin",hidden:!s.isStaff()}],[s]),j=g.useMemo(()=>Jt(),[]),S=g.useMemo(()=>Xt(n,s),[]);return e.jsxs(Oe,{direction:"column",mih:"100vh",p:16,children:[e.jsxs(E,{wrap:"nowrap",children:[e.jsx(Ee,{}),e.jsx(ke,{size:"xl",children:u})]}),e.jsx(M,{h:"xs"}),e.jsx(ye,{className:$e,p:0,children:e.jsxs(Le,{h:o,type:"always",offsetScrollbars:!0,children:[e.jsx(F,{title:c._({id:"UxKoFf"}),links:f,beforeClick:t}),e.jsx(F,{title:c._({id:"Tz0i8g"}),links:l,beforeClick:t}),e.jsx(F,{title:c._({id:"7L01XJ"}),links:a,beforeClick:t}),e.jsx(M,{h:"md"}),ze.length>0?e.jsx(F,{title:c._({id:"ohUJJM"}),links:ze,beforeClick:t}):e.jsx(e.Fragment,{})]})}),e.jsxs("div",{ref:i,children:[e.jsx(M,{h:"md"}),e.jsx(F,{title:c._({id:"TvY/XA"}),links:j,beforeClick:t}),e.jsx(M,{h:"md"}),e.jsx(F,{title:c._({id:"uyJsf6"}),links:S,beforeClick:t})]})]})}function Zs({notification:t,onRead:s}){var d,u,f;const n=W();let o=(d=t.target)==null?void 0:d.link;const r=(u=t.target)==null?void 0:u.model_type,i=(f=t.target)==null?void 0:f.model_id;if(r){const a=Qe[r];a!=null&&a.url_detail&&i?o=Bt(r,i):a!=null&&a.url_overview&&(o=a.url_overview)}return e.jsx(Ue,{p:"xs",shadow:"xs",children:e.jsxs(E,{justify:"space-between",wrap:"nowrap",children:[e.jsx(U,{label:t.message,position:"bottom-end",hidden:!t.message,children:e.jsxs(q,{gap:2,children:[e.jsx(je,{href:o?`/${Qt}${o}`:"#",underline:"hover",target:"_blank",onClick:a=>{o&&s(),o.startsWith("/")&&se(o,n,a)},children:e.jsx(T,{size:"sm",children:t.name})}),e.jsx(T,{size:"xs",children:t.age_human})]})}),e.jsx(U,{label:c._({id:"+s1J8k"}),position:"bottom-end",children:e.jsx(N,{variant:"transparent",onClick:s,children:e.jsx(Pe,{})})})]})})}function Ks({opened:t,onClose:s}){var f,a;const{isLoggedIn:n}=H(),o=W(),r=be({enabled:t&&n(),queryKey:["notifications",t],queryFn:async()=>J.get(X(Y.notifications_list),{params:{read:!1,limit:10,ordering:"-creation"}}).then(l=>l.data).catch(l=>l),refetchOnMount:!1}),i=g.useMemo(()=>{var l,j;return(((j=(l=r.data)==null?void 0:l.results)==null?void 0:j.length)??0)>0},[r.data]),d=g.useCallback(()=>{J.get(X(Y.notifications_readall),{params:{read:!1}}).catch(l=>{}).then(l=>{r.refetch()})},[]),u=g.useCallback(l=>{J.patch(X(Y.notifications_list,l.pk),{read:!0}).then(()=>{r.refetch()}).catch(()=>{r.refetch()})},[]);return e.jsx(_e,{opened:t,size:"md",position:"right",onClose:s,withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(E,{justify:"space-between",wrap:"nowrap",children:[e.jsx(ke,{size:"lg",children:c._({id:"iDNBZe"})}),e.jsxs(E,{justify:"end",wrap:"nowrap",children:[e.jsx(U,{label:c._({id:"onllUU"}),children:e.jsx(N,{variant:"transparent",onClick:()=>{d()},children:e.jsx(Pe,{})})}),e.jsx(U,{label:c._({id:"/WA/tl"}),children:e.jsx(N,{onClick:l=>{s(),se("/notifications/unread",o,l)},variant:"transparent",children:e.jsx(zt,{})})})]})]}),children:e.jsx(we,{label:"NotificationDrawer",children:e.jsxs(q,{gap:"xs",children:[e.jsx(ie,{}),!i&&e.jsx(Se,{color:"green",children:e.jsx(T,{size:"sm",children:c._({id:"t2pqHO"})})}),i&&((a=(f=r.data)==null?void 0:f.results)==null?void 0:a.map(l=>e.jsx(Zs,{notification:l,onRead:()=>u(l)},`notification-${l.pk}`))),r.isFetching&&e.jsx(He,{children:e.jsx(Me,{size:"sm"})})]})})})}function Gs({query:t,onRemove:s,onResultClick:n}){if(t.results.count==0)return null;const o=Ft(t.model);return e.jsx(Ue,{withBorder:!0,shadow:"sm",p:"md","aria-label":`search-group-${t.model}`,children:e.jsxs(q,{children:[e.jsxs(E,{justify:"space-between",wrap:"nowrap",children:[e.jsxs(E,{justify:"left",gap:5,wrap:"nowrap",children:[e.jsx(T,{size:"lg",children:o.label_multiple}),e.jsxs(T,{size:"sm",style:{fontStyle:"italic"},children:[" ","- ",t.results.count," ",e.jsx(D,{id:"mO8KLE"})]})]}),e.jsx(M,{}),e.jsx(N,{size:"sm",color:"red",variant:"transparent",radius:"xs","aria-label":`remove-search-group-${t.model}`,onClick:()=>s(t.model),children:e.jsx(Ht,{})})]}),e.jsx(ie,{}),e.jsx(q,{"aria-label":`search-group-results-${t.model}`,children:t.results.results.map(r=>e.jsx(je,{underline:"never",onClick:i=>n(t.model,r.pk,i),children:e.jsx(gs,{instance:r,model:t.model})},`result-${t.model}-${r.pk}`))}),e.jsx(M,{})]},`stack-${t.model}`)},`paper-${t.model}`)}function Js({opened:t,onClose:s}){const[n,o]=g.useState(""),[r]=Lt(n,500),[i,d]=g.useState(!1),[u,f]=g.useState(!1),a=H(),l=$t(),S=g.useMemo(()=>[{model:A.part,parameters:{active:l.isSet("SEARCH_HIDE_INACTIVE_PARTS")?!0:void 0},enabled:a.hasViewRole(y.part)&&l.isSet("SEARCH_PREVIEW_SHOW_PARTS")},{model:A.supplierpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:a.hasViewRole(y.part)&&a.hasViewRole(y.purchase_order)&&l.isSet("SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS")},{model:A.manufacturerpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:a.hasViewRole(y.part)&&a.hasViewRole(y.purchase_order)&&l.isSet("SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS")},{model:A.partcategory,parameters:{},enabled:a.hasViewRole(y.part_category)&&l.isSet("SEARCH_PREVIEW_SHOW_CATEGORIES")},{model:A.stockitem,parameters:{part_detail:!0,location_detail:!0,in_stock:l.isSet("SEARCH_PREVIEW_HIDE_UNAVAILABLE_STOCK")?!0:void 0},enabled:a.hasViewRole(y.stock)&&l.isSet("SEARCH_PREVIEW_SHOW_STOCK")},{model:A.stocklocation,parameters:{},enabled:a.hasViewRole(y.stock_location)&&l.isSet("SEARCH_PREVIEW_SHOW_LOCATIONS")},{model:A.build,parameters:{part_detail:!0},enabled:a.hasViewRole(y.build)&&l.isSet("SEARCH_PREVIEW_SHOW_BUILD_ORDERS")},{model:A.company,parameters:{},enabled:(a.hasViewRole(y.sales_order)||a.hasViewRole(y.purchase_order))&&l.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.purchaseorder,parameters:{supplier_detail:!0,outstanding:l.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_PURCHASE_ORDERS")?!0:void 0},enabled:a.hasViewRole(y.purchase_order)&&l.isSet("SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS")},{model:A.salesorder,parameters:{customer_detail:!0,outstanding:l.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_SALES_ORDERS")?!0:void 0},enabled:a.hasViewRole(y.sales_order)&&l.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDERS")},{model:A.returnorder,parameters:{customer_detail:!0,outstanding:l.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_RETURN_ORDERS")?!0:void 0},enabled:a.hasViewRole(y.return_order)&&l.isSet("SEARCH_PREVIEW_SHOW_RETURN_ORDERS")}],[a,l]).filter(m=>m.enabled);g.useEffect(()=>{h.refetch()},[r]);const h=be({queryKey:["search",r,i,u],queryFn:async()=>{if(!r)return[];const m={offset:0,limit:l.getSetting("SEARCH_PREVIEW_RESULTS","10"),search:r,search_regex:i,search_whole:u};return S.forEach(p=>{m[p.model]=p.parameters}),J.post(X(Y.api_search),m).then(p=>p.data).catch(p=>(console.error(p),[]))}}),[w,v]=g.useState([]);g.useEffect(()=>{if(h.data){let m=S.filter(p=>p.model in h.data);for(const p in h.data){const x=m.find(R=>R.model==p);x&&(x.results=h.data[p])}m=m.filter(p=>p.results.count>0),v(m)}else v([])},[h.data]);function I(m){v(w.filter(p=>p.model!=m))}function _(){o(""),s()}const B=W();function Q(m,p,x){const R=Qe[m];if(R.url_detail==null)return;x!=null&&x.ctrlKey||x!=null&&x.shiftKey||_();const V=R.url_detail.replace(":pk",p.toString());se(V,B,x)}return e.jsx(_e,{opened:t,size:"xl",onClose:_,position:"right",withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(E,{justify:"space-between",gap:1,wrap:"nowrap",children:[e.jsx(Dt,{"aria-label":"global-search-input",placeholder:c._({id:"Dwt0g3"}),value:n,onChange:m=>o(m.currentTarget.value),leftSection:e.jsx(oe,{size:"0.8rem"}),rightSection:n&&e.jsx(Tt,{color:"red",onClick:()=>o("")}),styles:{root:{width:"100%"}}}),e.jsx(U,{label:c._({id:"C0TDNl"}),position:"bottom-end",children:e.jsx(N,{size:"lg",variant:"transparent",onClick:()=>h.refetch(),children:e.jsx(Ot,{})})}),e.jsxs(b,{children:[e.jsx(b.Target,{children:e.jsx(U,{label:c._({id:"9UYKcs"}),position:"bottom-end",children:e.jsx(N,{size:"lg",variant:"transparent",children:e.jsx(Te,{})})})}),e.jsxs(b.Dropdown,{children:[e.jsx(b.Label,{children:c._({id:"9UYKcs"})}),e.jsx(b.Item,{children:e.jsx(Re,{label:c._({id:"qkCZlJ"}),checked:i,onChange:m=>d(m.currentTarget.checked)})}),e.jsx(b.Item,{children:e.jsx(Re,{label:c._({id:"roauu/"}),checked:u,onChange:m=>f(m.currentTarget.checked)})})]})]})]}),children:e.jsxs(we,{label:"SearchDrawer",children:[h.isFetching&&e.jsx(He,{children:e.jsx(Me,{})}),!h.isFetching&&!h.isError&&e.jsx(q,{gap:"md",children:w.map((m,p)=>e.jsx(Gs,{query:m,onRemove:x=>I(x),onResultClick:(x,R,V)=>Q(x,R,V)},p))}),h.isError&&e.jsx(Se,{color:"red",radius:"sm",variant:"light",title:c._({id:"SlfejT"}),icon:e.jsx(Pt,{size:"1rem"}),children:e.jsx(D,{id:"hJCuaV"})}),r&&!h.isFetching&&!h.isError&&w.length==0&&e.jsx(Se,{color:"blue",radius:"sm",variant:"light",title:c._({id:"MA3x23"}),icon:e.jsx(oe,{size:"1rem"}),children:e.jsx(D,{id:"dTtbrX"})})]})})}function Xs(){const[t,s]=We(v=>[v.setNavigationOpen,v.navigationOpen]),[n,{open:o,close:r}]=ne(s),[i,{open:d,close:u}]=ne(!1),[f,{open:a,close:l}]=ne(!1),{isLoggedIn:j}=H(),[S,k]=g.useState(0),h=Be(),w=be({queryKey:["notification-count"],enabled:j(),queryFn:async()=>{var v;if(!j())return null;try{const I={params:{read:!1,limit:1}},_=await J.get(X(Y.notifications_list),I).catch(()=>null);return k(((v=_==null?void 0:_.data)==null?void 0:v.count)??0),(_==null?void 0:_.data)??null}catch{return null}},refetchInterval:3e4,refetchOnMount:!0});return g.useEffect(()=>{s!==n&&t(n)},[n]),g.useEffect(()=>{s!==n&&(s?o():r())},[s]),e.jsxs("div",{className:is,children:[e.jsx(Js,{opened:i,onClose:u}),e.jsx(Fs,{opened:n,close:r}),e.jsx(Ks,{opened:f,onClose:()=>{w.refetch(),l()}}),e.jsx(ye,{className:os,size:"100%",children:e.jsxs(E,{justify:"space-between",children:[e.jsxs(E,{children:[e.jsx($s,{openDrawer:o}),e.jsx(Ys,{})]}),e.jsxs(E,{children:[e.jsx(N,{onClick:d,variant:"transparent","aria-label":"open-search",children:e.jsx(oe,{})}),e.jsx(Ws,{}),h.isSet("BARCODE_ENABLE")&&e.jsx(Us,{}),e.jsx(Mt,{radius:"lg",size:"18",label:S,color:"red",disabled:S<=0,inline:!0,children:e.jsx(N,{onClick:a,variant:"transparent","aria-label":"open-notifications",children:e.jsx(Ut,{})})}),e.jsx(Bs,{})]})]})})]})}function Ys(){const t=H(),s=W(),n=rs(":tabName/*"),o=n==null?void 0:n.params.tabName,r=g.useMemo(()=>{const i=[];return Ne.forEach(d=>{d.role&&!t.hasViewRole(d.role)||i.push(e.jsx(fe.Tab,{value:d.name,onClick:u=>se(`/${d.name}`,s,u),children:d.text},d.name))}),i},[Ne,t]);return e.jsx(fe,{defaultValue:"home",classNames:{root:as,list:ls,tab:cs},value:o,children:e.jsx(fe.List,{children:r.map(i=>i)})})}const en=({children:t})=>{const s=Fe(),{isLoggedIn:n}=H();return n()?t:e.jsx(us,{to:"/logged-in",state:{redirectUrl:s.pathname,queryParams:s.search,anchor:s.hash}})},[tn,sn]=Je();function pn(){const t=W(),s=Fe(),n=Hs(t),[o,r]=g.useState(n),[i,d]=g.useState(!1);return g.useEffect(()=>{i&&(r(n),d(!1))},[s]),e.jsx(en,{children:e.jsxs(Oe,{direction:"column",mih:"100vh",children:[e.jsx(Xs,{}),e.jsx(ye,{className:$e,size:"100%",children:e.jsx(we,{label:"layout",children:e.jsx(ds,{})})}),e.jsx(M,{h:"xl"}),e.jsx(Ms,{}),e.jsx(C,{actions:o,store:tn,highlightQuery:!0,searchProps:{leftSection:e.jsx(oe,{size:"1.2rem"}),placeholder:c._({id:"YIix5Y"})},shortcut:["mod + K","/"],nothingFound:c._({id:"cNfZ4r"})})]})})}export{en as ProtectedRoute,pn as default,sn as firstSpotlight,tn as firstStore};
