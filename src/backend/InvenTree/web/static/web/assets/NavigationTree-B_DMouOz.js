import{e9 as S,bA as A,r as x,j as a,G as p,bE as E,bz as z,cj as D,ea as N,A as F,cp as I,bk as K,S as L,bB as $,bF as B,eb as G}from"./vendor-BnaqX2_l.js";import{f as R,d as T,e as U}from"./index-fPzgLVil.js";import{n as q}from"./navigation-B-mN4luC.js";import{A as M}from"./ApiIcon-Bqf-O7I2.js";import{d as O,S as Q}from"./BaseContext-CH9A7-TB.js";function X({title:b,opened:c,onClose:g,selectedId:d,modelType:o,endpoint:w}){const h=O(),u=S(),r=A({enabled:c,queryKey:[o,c],queryFn:async()=>T.get(U(w),{data:{ordering:"level"}}).then(e=>e.data??[]).catch(e=>(console.error(`Error fetching ${o} tree`),[]))}),k=x.useCallback((e,s)=>{const i=R(o,e.value);s!=null&&s.shiftKey||s!=null&&s.ctrlKey?q(i,h,s):(g(),h(i))},[o,h]),v=x.useMemo(()=>{var i,f;const e={},s=[];if(!((i=r==null?void 0:r.data)!=null&&i.length))return[];for(let t=0;t<r.data.length;t++){const n={...r.data[t],children:[],label:a.jsxs(p,{gap:"xs",children:[a.jsx(M,{name:r.data[t].icon}),r.data[t].name]}),value:r.data[t].pk.toString(),selected:r.data[t].pk===d},j=n.pk,m=n.parent;if(m?(f=e[m])==null||f.children.push(n):s.push(n),e[j]=n,j===d){let l=e[n.parent];for(;l;)l.expanded=!0,l=e[l.parent]}}return s},[d,r.data]),C=x.useCallback(e=>a.jsxs(p,{justify:"left",wrap:"nowrap",onClick:()=>{e.hasChildren&&u.toggleExpanded(e.node.value)},children:[a.jsx(E,{w:5*e.level}),a.jsx(z,{size:"sm",variant:"transparent","aria-label":`nav-tree-toggle-${e.node.value}}`,children:e.hasChildren?e.expanded?a.jsx(D,{}):a.jsx(N,{}):null}),a.jsx(F,{onClick:s=>k(e.node,s),"aria-label":`nav-tree-item-${e.node.value}`,children:e.node.label})]},e.node.value),[u]);return a.jsx(I,{opened:c,size:"md",position:"left",onClose:g,withCloseButton:!0,styles:{header:{width:"100%"},title:{width:"100%"}},title:a.jsxs(p,{justify:"left",p:"ms",gap:"md",wrap:"nowrap",children:[a.jsx(K,{}),a.jsx(Q,{size:"lg",children:b})]}),children:a.jsxs(L,{gap:"xs",children:[a.jsx($,{}),a.jsx(B,{visible:r.isFetching||r.isLoading}),a.jsx(G,{data:v,tree:u,renderNode:C})]})})}export{X as N};
