import{ce as D,r as n,j as e,G as R,m as a,bC as y,i as t,cp as k,S as b,bG as C,d as g,bB as E,bD as s}from"./vendor-BnaqX2_l.js";import{S as x,E as j}from"./BaseContext-CH9A7-TB.js";import{P as S}from"./YesNoButton-W51do83Q.js";import{s as U,d as A}from"./Instance-DrUTN1gu.js";import{a as F,l as v,U as M,A as T,e as O}from"./index-fPzgLVil.js";import{c as G}from"./UseFilter-qbbXWiSh.js";import{b as P}from"./UseForm-DwZIxEnj.js";import{u as I,a as W,I as q}from"./InvenTreeTable-rEa-i3pt.js";import"./navigation-B-mN4luC.js";import"./ApiIcon-Bqf-O7I2.js";import"./dayjs.min-DlCiWWGX.js";import"./DesktopAppView-CAvOv5f4.js";import"./ActionDropdown-D1A3arjv.js";function H({scan:r}){const o={textWrap:"wrap",lineBreak:"auto",wordBreak:"break-word"},c=n.useMemo(()=>r.response&&Object.keys(r.response).length>0,[r.response]),d=n.useMemo(()=>r.context&&Object.keys(r.context).length>0,[r.context]);return e.jsxs(b,{gap:"xs",children:[e.jsx(E,{}),e.jsx(s,{children:e.jsxs(s.Tbody,{children:[e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"HsJeTk"})})})}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"ap+FLU"})}),e.jsx(s.Td,{children:e.jsx(a,{size:"sm",style:o,children:r.data})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.data,size:"xs"})})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"8TMaZI"})}),e.jsx(s.Td,{children:r.timestamp})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"7PzzBU"})}),e.jsx(s.Td,{children:e.jsx(A,{instance:r.user_detail})})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"FCKppt"})}),e.jsx(s.Td,{children:r.endpoint})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"RD6AE9"})}),e.jsx(s.Td,{children:e.jsx(S,{value:r.result})})]}),d&&e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"M73whl"})})})}),d&&Object.keys(r.context).map(i=>e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:i}),e.jsx(s.Td,{children:e.jsx(a,{size:"sm",style:o,children:r.context[i]})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.context[i],size:"xs"})})]},i)),c&&e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"ZlCDf+"})})})}),c&&Object.keys(r.response).map(i=>e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:i}),e.jsx(s.Td,{children:e.jsx(a,{size:"sm",style:o,children:r.response[i]})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.response[i],size:"xs"})})]},i))]})})]})}function te(){const r=F(),o=I("barcode-history"),c=v(),d=G(),[i,{open:_,close:f}]=D(!1),z=n.useMemo(()=>[{accessor:"timestamp",sortable:!0,switchable:!1,render:l=>e.jsxs(R,{justify:"space-between",wrap:"nowrap",children:[e.jsx(a,{children:l.timestamp}),l.user_detail&&e.jsx(y,{size:"xs",children:l.user_detail.username})]})},{accessor:"data",sortable:!1,switchable:!0,render:l=>e.jsx(a,{size:"xs",style:{textWrap:"wrap",lineBreak:"auto",wordBreak:"break-word"},children:U({str:l.data,len:100})})},{accessor:"endpoint",sortable:!0},{accessor:"result",sortable:!0,render:l=>e.jsx(S,{value:l.result})}],[]),w=n.useMemo(()=>[{name:"user",label:t._({id:"7PzzBU"}),choices:d.choices,description:t._({id:"FVjW63"})},{name:"result",label:t._({id:"RD6AE9"}),description:t._({id:"+Bt9q7"})}],[d]),h=n.useMemo(()=>r.isStaff()&&r.hasDeleteRole(M.admin),[r]),[u,p]=n.useState({}),m=P({url:T.barcode_history,pk:u.pk,title:t._({id:"XBxqOY"}),table:o}),B=n.useCallback(l=>[W({hidden:!h,onClick:()=>{p(l),m.open()}})],[h,r]);return e.jsxs(e.Fragment,{children:[m.modal,e.jsx(k,{opened:i,size:"xl",position:"right",title:e.jsx(x,{children:t._({id:"y1GSyz"})}),onClose:f,children:e.jsx(H,{scan:u})}),e.jsxs(b,{gap:"xs",children:[!c.isSet("BARCODE_STORE_RESULTS")&&e.jsx(C,{color:"red",icon:e.jsx(g,{}),title:t._({id:"d20v+o"}),children:e.jsx(a,{children:t._({id:"y6SrPr"})})}),e.jsx(q,{url:O(T.barcode_history),tableState:o,columns:z,props:{tableFilters:w,enableBulkDelete:h,rowActions:B,onRowClick:l=>{p(l),_()}}})]})]})}export{te as default};
