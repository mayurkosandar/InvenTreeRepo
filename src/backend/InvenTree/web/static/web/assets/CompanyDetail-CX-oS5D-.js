import{r as i,i as t,j as s,ci as C,cT as A,Z as L,aj as O,cU as v,a6 as G,a1 as B,am as U,an as W,cV as Y,b5 as Q,aG as V,S as K}from"./vendor-BnaqX2_l.js";import{A as H}from"./AdminButton-GD-Bfrm9.js";import{I as Z,D as F,a as $}from"./InstanceDetail-DvLVYRQt.js";import{D as q}from"./DetailsBadge-CfxzC3Fy.js";import{D as z,N as J}from"./NotesPanel-Dh1SrbjV.js";import{O as X,E as ee,D as se}from"./ActionDropdown-D1A3arjv.js";import{P as te}from"./PageDetail-Ct_zKLxm.js";import{A as ae}from"./AttachmentPanel-Ct80LGG4.js";import{P as oe}from"./PanelGroup-CKTRVRga.js";import{a as w,A as n,U as r,e as I,m as j}from"./index-fPzgLVil.js";import{c as re}from"./CompanyForms-yUzzFM8E.js";import{u as S,a as D,b as R,A as T}from"./UseForm-DwZIxEnj.js";import{u as ie}from"./UseInstance-DbDyyJjp.js";import{Y as ne}from"./YesNoButton-W51do83Q.js";import{u as P,R as y,a as E,I as N}from"./InvenTreeTable-rEa-i3pt.js";import{L as le}from"./ColumnRenderers-6jyK6a0i.js";import{M as ce}from"./ManufacturerPartTable-CQelW7oj.js";import{P as de}from"./PurchaseOrderTable-DoRDjD5w.js";import{S as pe}from"./SupplierPartTable-BYXaclYG.js";import{S as me,R as ue}from"./SalesOrderTable-DyBv1MZo.js";import{S as M}from"./StockItemTable-Blig3z9s.js";import{C as he}from"./BaseContext-CH9A7-TB.js";import"./formatters-DBeaC9UC.js";import"./dayjs.min-DlCiWWGX.js";import"./navigation-B-mN4luC.js";import"./Instance-DrUTN1gu.js";import"./ApiIcon-Bqf-O7I2.js";import"./GenericErrorPage-BDqvbBMU.js";import"./NotFound-Dr2EC1Qm.js";import"./PermissionDenied-BHX44oqK.js";import"./PageTitle-AnZP781e.js";import"./AttachmentLink-BJMgqQK8.js";import"./RemoteComponent-Who-27QQ.js";import"./DesktopAppView-CAvOv5f4.js";import"./PurchaseOrderForms-DPVzsVCo.js";import"./RemoveRowButton-Dm_wD7jw.js";import"./UseGenerator-DOw_SLei.js";import"./UseFilter-qbbXWiSh.js";import"./ReturnOrderForms-CfoSxIhw.js";import"./SalesOrderForms-CNvk5nqw.js";import"./OrderPartsWizard-BFgDSSVd.js";import"./UsePlaceholder-Dc_Ugorx.js";function _e({companyId:m,params:u}){const o=w(),e=P("address"),h=i.useMemo(()=>[{accessor:"title",sortable:!0,switchable:!1},{accessor:"primary",switchable:!1,sortable:!1,render:a=>ne({value:a.primary})},{accessor:"address",title:t._({id:"Du6bPw"}),sortable:!1,switchable:!1,render:a=>{let d="";return a!=null&&a.line1&&(d+=a.line1),a!=null&&a.line2&&(d+=` ${a.line2}`),d.trim()}},{accessor:"postal_code",sortable:!1,switchable:!0},{accessor:"postal_city",sortable:!1,switchable:!0},{accessor:"province",sortable:!1,switchable:!0},{accessor:"country",sortable:!1,switchable:!0},{accessor:"shipping_notes",sortable:!1,switchable:!0},{accessor:"internal_shipping_notes",sortable:!1,switchable:!0},le({})],[]),l=i.useMemo(()=>({company:{},title:{},primary:{},line1:{},line2:{},postal_code:{},postal_city:{},province:{},country:{},shipping_notes:{},internal_shipping_notes:{},link:{}}),[]),_=S({url:n.address_list,title:t._({id:"W0pjLr"}),fields:l,initialData:{company:m},successMessage:t._({id:"N0ZOat"}),table:e}),[b,f]=i.useState(-1),c=D({url:n.address_list,pk:b,title:t._({id:"xLQ0lF"}),fields:l,table:e}),p=R({url:n.address_list,pk:b,title:t._({id:"xiRN5x"}),preFormWarning:t._({id:"F1bgq9"}),table:e}),k=i.useCallback(a=>{const d=o.hasChangeRole(r.purchase_order)||o.hasChangeRole(r.sales_order),g=o.hasDeleteRole(r.purchase_order)||o.hasDeleteRole(r.sales_order);return[y({hidden:!d,onClick:()=>{f(a.pk),c.open()}}),E({hidden:!g,onClick:()=>{f(a.pk),p.open()}})]},[o]),x=i.useMemo(()=>{const a=o.hasChangeRole(r.purchase_order)||o.hasChangeRole(r.sales_order);return[s.jsx(T,{tooltip:t._({id:"W0pjLr"}),onClick:()=>_.open(),hidden:!a},"add-address")]},[o]);return s.jsxs(s.Fragment,{children:[_.modal,c.modal,p.modal,s.jsx(N,{url:I(n.address_list),tableState:e,columns:h,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...u,company:m}}})]})}function be({companyId:m,params:u}){const o=w(),e=P("contact"),h=i.useMemo(()=>[{accessor:"name",sortable:!0,switchable:!1},{accessor:"phone",switchable:!0,sortable:!1},{accessor:"email",switchable:!0,sortable:!1},{accessor:"role",switchable:!0,sortable:!1}],[]),l=i.useMemo(()=>({company:{},name:{},phone:{},email:{},role:{}}),[]),[_,b]=i.useState(0),f=D({url:n.contact_list,pk:_,title:t._({id:"mQpWAe"}),fields:l,onFormSuccess:a=>e.updateRecord(a)}),c=S({url:n.contact_list,title:t._({id:"M0FgOk"}),initialData:{company:m},fields:l,table:e}),p=R({url:n.contact_list,pk:_,title:t._({id:"0oMKRL"}),table:e}),k=i.useCallback(a=>{const d=o.hasChangeRole(r.purchase_order)||o.hasChangeRole(r.sales_order),g=o.hasDeleteRole(r.purchase_order)||o.hasDeleteRole(r.sales_order);return[y({hidden:!d,onClick:()=>{b(a.pk),f.open()}}),E({hidden:!g,onClick:()=>{b(a.pk),p.open()}})]},[o]),x=i.useMemo(()=>{const a=o.hasAddRole(r.purchase_order)||o.hasAddRole(r.sales_order);return[s.jsx(T,{tooltip:t._({id:"QsNWTM"}),onClick:()=>c.open(),hidden:!a},"add-contact")]},[o]);return s.jsxs(s.Fragment,{children:[c.modal,f.modal,p.modal,s.jsx(N,{url:I(n.contact_list),tableState:e,columns:h,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...u,company:m}}})]})}function rs(m){const{id:u}=he(),o=w(),{instance:e,refreshInstance:h,instanceQuery:l,requestStatus:_}=ie({endpoint:n.company_list,pk:u,params:{},refetchOnMount:!0}),b=i.useMemo(()=>{if(l.isFetching)return s.jsx(C,{});const a=[{type:"text",name:"description",label:t._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"website",label:t._({id:"On0aF2"}),external:!0,copy:!0,hidden:!e.website},{type:"text",name:"phone",label:t._({id:"HF6C2L"}),copy:!0,hidden:!e.phone},{type:"text",name:"email",label:t._({id:"hzKQCy"}),copy:!0,hidden:!e.email}],d=[{type:"string",name:"currency",label:t._({id:"xjO9oI"})},{type:"boolean",name:"is_supplier",label:t._({id:"PYTEl0"}),icon:"suppliers"},{type:"boolean",name:"is_manufacturer",label:t._({id:"+m9/3S"}),icon:"manufacturers"},{type:"boolean",name:"is_customer",label:t._({id:"876pfE"}),icon:"customers"}];return s.jsxs(Z,{children:[s.jsxs(A,{children:[s.jsx(A.Col,{span:4,children:s.jsx(z,{appRole:r.purchase_order,apiPath:I(n.company_list,e.pk),src:e.image,pk:e.pk,refresh:h,imageActions:{uploadFile:!0,downloadImage:!0,deleteFile:!0}})}),s.jsx(A.Col,{span:8,children:s.jsx(F,{item:e,fields:a})})]}),s.jsx(F,{item:e,fields:d})]})},[e,l]),f=i.useMemo(()=>[{name:"details",label:t._({id:"eDkDvt"}),icon:s.jsx(L,{}),content:b},{name:"manufactured-parts",label:t._({id:"glJbgw"}),icon:s.jsx(O,{}),hidden:!(e!=null&&e.is_manufacturer),content:(e==null?void 0:e.pk)&&s.jsx(ce,{params:{manufacturer:e.pk}})},{name:"supplied-parts",label:t._({id:"i4b9ex"}),icon:s.jsx(v,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(pe,{params:{supplier:e.pk}})},{name:"purchase-orders",label:t._({id:"85Yvr2"}),icon:s.jsx(G,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(de,{supplierId:e.pk})},{name:"stock-items",label:t._({id:"Jbck4N"}),icon:s.jsx(B,{}),hidden:!(e!=null&&e.is_manufacturer)&&!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(M,{allowAdd:!1,tableName:"company-stock",params:{company:e.pk}})},{name:"sales-orders",label:t._({id:"B1TL+X"}),icon:s.jsx(U,{}),hidden:!(e!=null&&e.is_customer),content:(e==null?void 0:e.pk)&&s.jsx(me,{customerId:e.pk})},{name:"return-orders",label:t._({id:"LlTg8M"}),icon:s.jsx(W,{}),hidden:!(e!=null&&e.is_customer),content:e.pk?s.jsx(ue,{customerId:e.pk}):s.jsx(C,{})},{name:"assigned-stock",label:t._({id:"TVGEcl"}),icon:s.jsx(Y,{}),hidden:!(e!=null&&e.is_customer),content:e!=null&&e.pk?s.jsx(M,{allowAdd:!1,tableName:"assigned-stock",showLocation:!1,params:{customer:e.pk}}):s.jsx(C,{})},{name:"contacts",label:t._({id:"gVfVfe"}),icon:s.jsx(Q,{}),content:(e==null?void 0:e.pk)&&s.jsx(be,{companyId:e.pk})},{name:"addresses",label:t._({id:"bYmAV1"}),icon:s.jsx(V,{}),content:(e==null?void 0:e.pk)&&s.jsx(_e,{companyId:e.pk})},ae({model_type:j.company,model_id:e.pk}),J({model_type:j.company,model_id:e.pk})],[u,e,o]),c=D({url:n.company_list,pk:e==null?void 0:e.pk,title:t._({id:"HoG6cl"}),fields:re(),onFormSuccess:h}),p=R({url:n.company_list,pk:e==null?void 0:e.pk,title:t._({id:"riHm27"}),onFormSuccess:h}),k=i.useMemo(()=>[s.jsx(H,{model:j.company,id:e.pk}),s.jsx(X,{tooltip:t._({id:"z+ZEYC"}),actions:[ee({hidden:!o.hasChangeRole(r.purchase_order),onClick:()=>c.open()}),se({hidden:!o.hasDeleteRole(r.purchase_order),onClick:()=>p.open()})]})],[u,e,o]),x=i.useMemo(()=>[s.jsx(q,{label:t._({id:"NoNwIX"}),color:"red",visible:e.active==!1})],[e]);return s.jsxs(s.Fragment,{children:[c.modal,p.modal,s.jsx($,{status:_,loading:l.isFetching,children:s.jsxs(K,{gap:"xs",children:[s.jsx(te,{title:`${t._({id:"7i8j3G"})}: ${e.name}`,subtitle:e.description,actions:k,imageUrl:e.image,breadcrumbs:m.breadcrumbs,badges:x,editAction:c.open,editEnabled:o.hasChangePermission(j.company)}),s.jsx(oe,{pageKey:"company",panels:f,instance:e,model:j.company,id:e.pk})]})})]})}export{rs as default};
