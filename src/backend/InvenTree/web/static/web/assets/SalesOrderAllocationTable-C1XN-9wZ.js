import{r as a,i as t,j as c}from"./vendor-BnaqX2_l.js";import{f as D}from"./formatters-DBeaC9UC.js";import{a as B,m as k,A as m,e as E}from"./index-fPzgLVil.js";import{a as L}from"./SalesOrderForms-CNvk5nqw.js";import{a as U,b as Y}from"./UseForm-DwZIxEnj.js";import{u as J,R as K,a as N,I as Q}from"./InvenTreeTable-rEa-i3pt.js";import{R as V,S as Z,a as z,h as G}from"./ColumnRenderers-6jyK6a0i.js";function ee({partId:l,stockId:C,orderId:u,lineItemId:F,shipmentId:S,showPartInfo:o,showOrderInfo:n,allowEdit:r,isSubTable:s,modelTarget:M,modelField:g}){const p=B(),v=a.useMemo(()=>{let e="salesorderallocations";return l&&(e+="-part"),s&&(e+="-sub"),e},[l,s]),d=J(v),w=a.useMemo(()=>{const e=[{name:"outstanding",label:t._({id:"aimnwe"}),description:t._({id:"ILsgZ4"})},{name:"assigned_to_shipment",label:t._({id:"uvBviC"}),description:t._({id:"U6KGSj"})}];return l&&e.push({name:"include_variants",type:"boolean",label:t._({id:"/g9i/Z"}),description:t._({id:"NkXwQy"})}),e},[l]),x=a.useMemo(()=>[V({accessor:"order_detail.reference",title:t._({id:"LozYBo"}),switchable:!1,sortable:!0,hidden:n!=!0}),{accessor:"order_detail.description",title:t._({id:"Nu4oKW"}),hidden:n!=!0},Z({accessor:"order_detail.status",model:k.salesorder,title:t._({id:"acIJ41"}),hidden:n!=!0}),{accessor:"part",hidden:o!=!0,title:t._({id:"vgP+9p"}),sortable:!0,switchable:!1,render:e=>z({part:e.part_detail})},{accessor:"serial",title:t._({id:"AXeJt4"}),sortable:!0,switchable:!0,render:e=>{var i;return(i=e==null?void 0:e.item_detail)==null?void 0:i.serial}},{accessor:"batch",title:t._({id:"Vea6Aj"}),sortable:!0,switchable:!0,render:e=>{var i;return(i=e==null?void 0:e.item_detail)==null?void 0:i.batch}},{accessor:"available",title:t._({id:"I8CEek"}),sortable:!1,hidden:s,render:e=>{var i;return(i=e==null?void 0:e.item_detail)==null?void 0:i.quantity}},{accessor:"quantity",title:t._({id:"Tk6w1l"}),sortable:!0},G({accessor:"location_detail",switchable:!0,sortable:!0}),{accessor:"shipment_detail.reference",title:t._({id:"4fws5M"}),switchable:!0,sortable:!1,render:e=>{var i;return((i=e.shipment_detail)==null?void 0:i.reference)??t._({id:"Xmnh8X"})}},{accessor:"shipment_date",title:t._({id:"MFQxyA"}),switchable:!0,sortable:!0,render:e=>{var i;return(i=e.shipment_detail)!=null&&i.shipment_date?D(e.shipment_detail.shipment_date):e.shipment?t._({id:"BVdqnq"}):t._({id:"Xmnh8X"})}}],[n,o,s]),[_,h]=a.useState(0),[y,R]=a.useState(null),j=L({orderId:u,shipment:y}),f=U({url:m.sales_order_allocation_list,pk:_,fields:j,title:t._({id:"+2kti8"}),onFormSuccess:()=>d.refreshTable()}),b=Y({url:m.sales_order_allocation_list,pk:_,title:t._({id:"m9p8qY"}),onFormSuccess:()=>d.refreshTable()}),q=a.useCallback(e=>{var A;return!!((A=e.shipment_detail)!=null&&A.shipment_date)||!r?[]:[K({tooltip:t._({id:"+2kti8"}),onClick:()=>{h(e.pk),R(e.shipment),f.open()}}),N({tooltip:t._({id:"m9p8qY"}),onClick:()=>{h(e.pk),b.open()}})]},[r,p]),X=a.useMemo(()=>r?[]:[],[r,p]);return c.jsxs(c.Fragment,{children:[f.modal,b.modal,c.jsx(Q,{url:E(m.sales_order_allocation_list),tableState:d,columns:x,props:{params:{part_detail:o??!1,order_detail:n??!1,item_detail:!0,location_detail:!0,line:F,part:l,order:u,shipment:S,item:C},enableSearch:!s,enableRefresh:!s,enableColumnSwitching:!s,enableFilters:!s,enableDownload:!s,minHeight:s?100:void 0,rowActions:q,tableActions:X,tableFilters:w,modelField:g??"order",modelType:M??k.salesorder}})]})}export{ee as S};
