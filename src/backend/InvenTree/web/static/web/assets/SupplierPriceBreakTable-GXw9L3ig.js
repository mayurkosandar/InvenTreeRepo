import{r as p,i as s,j as a,G as x,m as c,A}from"./vendor-BnaqX2_l.js";import{u as j,a as w,b as S,A as T}from"./UseForm-DwZIxEnj.js";import{T as P}from"./Instance-DrUTN1gu.js";import{b as f}from"./formatters-DBeaC9UC.js";import{a as B,e as n,A as u,U as o,f as U,m as C}from"./index-fPzgLVil.js";import{u as R,R as q,a as M,I as E}from"./InvenTreeTable-rEa-i3pt.js";function D(e){var r;const t=((r=e==null?void 0:e.part_detail)==null?void 0:r.pack_quantity_native)??1;return e.price/t}function F(){return[{accessor:"supplier",title:s._({id:"PYTEl0"}),sortable:!0,switchable:!0,render:e=>{var t,i,r,l;return a.jsxs(x,{gap:"xs",wrap:"nowrap",children:[a.jsx(P,{src:((t=e==null?void 0:e.supplier_detail)==null?void 0:t.thumbnail)??((i=e==null?void 0:e.supplier_detail)==null?void 0:i.image),alt:(r=e==null?void 0:e.supplier_detail)==null?void 0:r.name,size:24}),a.jsx(c,{children:(l=e.supplier_detail)==null?void 0:l.name})]})}},{accessor:"part_detail.SKU",title:s._({id:"y90mqQ"}),ordering:"SKU",sortable:!0,switchable:!1,render:e=>a.jsx(A,{href:U(C.supplierpart,e.part_detail.pk,!0),children:e.part_detail.SKU})},{accessor:"quantity",title:s._({id:"VbWX2u"}),sortable:!0,switchable:!1},{accessor:"price",title:s._({id:"kk1/TT"}),render:e=>f(e.price,{currency:e.price_currency}),sortable:!0,switchable:!1},{accessor:"unit_price",ordering:"price",title:s._({id:"vWelsN"}),sortable:!0,switchable:!0,render:e=>{var r;const t=(r=e.part_detail)==null?void 0:r.pack_quantity,i=f(D(e),{currency:e.price_currency});return a.jsxs(x,{justify:"space-between",gap:"xs",grow:!0,children:[a.jsx(c,{children:i}),t&&a.jsxs(c,{size:"xs",children:["[",t,"]"]})]})}}]}function I({supplierPartId:e}){const t=R("supplierpricebreaks"),i=B(),r=p.useMemo(()=>F(),[]),l=p.useMemo(()=>({part:{hidden:!1,disabled:!0},quantity:{},price:{},price_currency:{}}),[]),[d,_]=p.useState(0),m=j({url:n(u.supplier_part_pricing_list),title:s._({id:"SXdWxL"}),fields:l,initialData:{part:e},table:t}),b=w({url:n(u.supplier_part_pricing_list),pk:d,title:s._({id:"l3gpbq"}),fields:l,table:t}),h=S({url:n(u.supplier_part_pricing_list),pk:d,title:s._({id:"ynVh1t"}),table:t}),y=p.useMemo(()=>[a.jsx(T,{tooltip:s._({id:"SXdWxL"}),onClick:()=>{m.open()},hidden:!i.hasAddRole(o.part)},"add-price-break")],[i]),g=p.useCallback(k=>[q({hidden:!i.hasChangeRole(o.purchase_order),onClick:()=>{_(k.pk),b.open()}}),M({hidden:!i.hasDeleteRole(o.purchase_order),onClick:()=>{_(k.pk),h.open()}})],[i]);return a.jsxs(a.Fragment,{children:[m.modal,b.modal,h.modal,a.jsx(E,{url:n(u.supplier_part_pricing_list),columns:r,tableState:t,props:{params:{part:e,part_detail:!0,supplier_detail:!0},tableActions:y,rowActions:g}})]})}export{I as S,F as a,D as c};
