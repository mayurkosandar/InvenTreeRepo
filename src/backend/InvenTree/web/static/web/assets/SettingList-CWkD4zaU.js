import{cg as w,j as c,J as R,G as M,S as _,m as x,r as i,bE as U,v as b,ac as F,dy as G,i as m,n as f,R as z,eI as E}from"./vendor-BnaqX2_l.js";import{r as V,T as $}from"./BaseContext-CH9A7-TB.js";import{v as k,n as q,l as I,d as B,e as C,E as A,F as D}from"./index-fPzgLVil.js";import{a as J}from"./UseForm-DwZIxEnj.js";function K({setting:e,onEdit:l,onToggle:a}){const s=i.useMemo(()=>{var u;let r=e.value;if(e!=null&&e.choices&&((u=e==null?void 0:e.choices)==null?void 0:u.length)>0){const n=e.choices.find(d=>d.value==e.value);r=(n==null?void 0:n.display_name)||e.value}return e!=null&&e.units&&(r=`${r} ${e.units}`),r},[e]);switch((e==null?void 0:e.type)||"string"){case"boolean":return c.jsx(G,{size:"sm",radius:"lg",checked:e.value.toLowerCase()=="true",onChange:r=>a(e,r.currentTarget.checked),style:{paddingRight:"20px"}});default:return s?c.jsxs(M,{gap:"xs",justify:"right",children:[c.jsx(U,{}),c.jsx(b,{variant:"subtle",onClick:()=>l(e),children:s})]}):c.jsx(b,{variant:"subtle",onClick:()=>l(e),children:c.jsx(F,{})})}}function N({setting:e,shaded:l,onEdit:a,onToggle:s}){const{colorScheme:r}=w(),u={paddingLeft:"8px"};return l&&(u.backgroundColor=r==="light"?k.colors.gray[1]:k.colors.gray[9]),c.jsx(R,{style:u,children:c.jsxs(M,{justify:"space-between",p:"3",children:[c.jsxs(_,{gap:"2",p:"4px",children:[c.jsxs(x,{children:[e.name,e.required?" *":""]}),c.jsx(x,{size:"xs",children:e.description})]}),c.jsx(V,{label:`setting-value-${e.key}`,children:c.jsx(K,{setting:e,onEdit:a,onToggle:s})})]})})}function j({settingsState:e,keys:l,onChange:a}){var y,t,v;i.useEffect(()=>{e.fetchSettings()},[]);const s=i.useMemo(()=>{var o;return((o=e==null?void 0:e.settings)==null?void 0:o.map(p=>p.key))??[]},[e==null?void 0:e.settings]),[r,u]=i.useState(void 0),n=i.useMemo(()=>{var o;return(o=r==null?void 0:r.choices)!=null&&o.length?"choice":(r==null?void 0:r.type)!=null?r.type:"string"},[r]),d=J({url:e.endpoint,pk:r==null?void 0:r.key,pathParams:e.pathParams,title:m._({id:"mjN1LS"}),fields:{value:{field_type:n,required:(r==null?void 0:r.required)??!1,label:r==null?void 0:r.name,description:r==null?void 0:r.description,api_url:(r==null?void 0:r.api_url)??"",model:((y=r==null?void 0:r.model_name)==null?void 0:y.split(".")[1])??null,choices:(r==null?void 0:r.choices)??void 0}},successMessage:m._({id:"n/n6vh",values:{0:r==null?void 0:r.key}}),onFormSuccess:()=>{e.fetchSettings(),a==null||a()}}),L=i.useCallback(o=>{u(o),d.open()},[d]),T=i.useCallback((o,p)=>{B.patch(C(e.endpoint,o.key,e.pathParams),{value:p}).then(()=>{f.hide("setting"),f.show({title:m._({id:"C3htzi"}),message:m._({id:"n/n6vh",values:{0:o.key}}),color:"green",id:"setting"}),a==null||a()}).catch(h=>{f.hide("setting"),f.show({title:m._({id:"CsUgn+"}),message:h.message,color:"red",id:"setting"})}).finally(()=>{e.fetchSettings()})},[e]);return c.jsxs(c.Fragment,{children:[d.modal,c.jsxs(_,{gap:"xs",children:[(t=l||s)==null?void 0:t.map((o,p)=>{var S;const h=(S=e==null?void 0:e.settings)==null?void 0:S.find(P=>P.key===o);return e!=null&&e.settings&&!h&&console.error(`Setting ${o} not found`),c.jsx(z.Fragment,{children:h?c.jsx(N,{setting:h,shaded:p%2===0,onEdit:L,onToggle:T}):c.jsxs(x,{size:"sm",style:{fontStyle:"italic"},c:"red",children:["Setting ",o," not found"]})},o)}),((v=l||s)==null?void 0:v.length)===0&&c.jsx(x,{style:{fontStyle:"italic"},children:c.jsx($,{id:"3CUVvD"})})]})]})}function X({keys:e}){const l=q();return c.jsx(j,{settingsState:l,keys:e})}function Y({keys:e}){const l=I();return c.jsx(j,{settingsState:l,keys:e})}function Z({pluginKey:e}){const l=i.useRef(A({plugin:e})).current,a=E(l);return c.jsx(j,{settingsState:a})}function g({machinePk:e,configType:l,onChange:a}){const s=i.useRef(D({machine:e,configType:l})).current,r=E(s);return c.jsx(j,{settingsState:r,onChange:a})}export{Y as G,g as M,Z as P,X as U};
