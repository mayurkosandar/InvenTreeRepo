import{cg as S,c4 as y,r,i as x,j as n,S as p,bG as m,d as g,m as h}from"./vendor-BnaqX2_l.js";import{u as E,a as _,l as $,n as w,d as j,q as v,g as C,w as b}from"./index-fPzgLVil.js";import{d as H,r as M}from"./BaseContext-CH9A7-TB.js";const I=()=>{const e=E(c=>c.host),s=H(),i=_(),{colorScheme:o}=S(),u=y(),l=$(),a=w();return r.useMemo(()=>({user:i,host:e,api:j,queryClient:v,navigate:s,globalSettings:l,userSettings:a,theme:u,colorScheme:o}),[i,e,j,v,s,l,a,u,o])};var P=(e=>(e.dashboard="dashboard",e.panel="panel",e.template_editor="template_editor",e.template_preview="template_preview",e))(P||{});const T=(e,s)=>r.forwardRef((i,o)=>{const u=r.useRef(),[l,a]=r.useState(void 0),t=r.useRef(),c=r.useRef(),d=r.useRef();return r.useImperativeHandle(o,()=>({setCode:f=>{c.current?c.current(f):t.current=f},getCode:()=>{var f;return(f=d.current)==null?void 0:f.call(d)}})),r.useEffect(()=>{(async()=>{try{e({ref:u.current,registerHandlers:({getCode:f,setCode:R})=>{c.current=R,d.current=f,t.current&&R(t.current)},template:s})}catch(f){a(x._({id:"t3xUfw"})),console.error(f)}})()},[]),n.jsxs(p,{gap:"xs",style:{display:"flex",flex:1},children:[l&&n.jsx(m,{color:"red",title:x._({id:"JDFeOe"}),icon:n.jsx(g,{}),children:n.jsx(h,{children:l})}),n.jsx("div",{ref:u,style:{display:"flex",flex:1}})]})}),Y=(e,s)=>r.forwardRef((i,o)=>{const u=r.useRef(),[l,a]=r.useState(void 0),t=r.useRef();return r.useImperativeHandle(o,()=>({updatePreview:(...c)=>{var d;return(d=t.current)==null?void 0:d.call(t,...c)}})),r.useEffect(()=>{(async()=>{try{e({ref:u.current,registerHandlers:({updatePreview:c})=>{t.current=c},template:s})}catch(c){a(x._({id:"KJx0of"})),console.error(c)}})()},[]),n.jsxs(p,{gap:"xs",style:{display:"flex",flex:1},children:[l&&n.jsx(m,{color:"red",title:x._({id:"OqfJdc"}),icon:n.jsx(g,{}),children:n.jsx(h,{children:l})}),n.jsx("div",{ref:u,style:{display:"flex",flex:1}})]})});async function q(e){if(e=e.trim(),!e)return null;const s=C(e);return await import(s).catch(o=>(console.error(`ERR: Failed to load plugin from ${s}:`,o),null)).then(o=>o)}async function D(e,s){e.includes(":")&&([e,s]=e.split(":"));const i=await q(e);return i!=null&&i[s]?i[s]:null}function k({source:e,defaultFunctionName:s,context:i}){const o=r.useRef(),[u,l]=r.useState(void 0),a=r.useMemo(()=>e.split(":")[0],[e]),t=r.useMemo(()=>e.includes(":")?e.split(":")[1]:s,[e,s]),c=async()=>{o.current&&(a&&t?D(a,t).then(d=>{if(d)try{d(o.current,i),l("")}catch(f){l(`${f}`)}else l(`${a}:${t}`)}).catch(d=>{console.error(`ERR: Failed to load remove plugin function: ${a}:${t}`)}):l(`${x._({id:"wOa7Q9"})} - ${a}:${t}`))};return r.useEffect(()=>{c()},[a,t,i]),n.jsx(M,{label:b(`RemoteComponent-${a}-${t}`),children:n.jsxs(p,{gap:"xs",children:[u&&n.jsx(m,{color:"red",title:x._({id:"HY5802"}),icon:n.jsx(g,{}),children:n.jsxs(h,{children:[x._({id:"IYgnvh"}),": ",u]})}),n.jsx("div",{ref:o})]})})}export{P,k as R,Y as a,D as f,T as g,I as u};
