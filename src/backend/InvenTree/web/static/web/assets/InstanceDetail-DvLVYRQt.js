import{j as a,J as w,S as I,bD as c,r as x,m as u,G as _,bA as T,ci as B,A as S,i as f,bC as L,co as D,bF as P}from"./vendor-BnaqX2_l.js";import{r as z}from"./InvenTreeTable-rEa-i3pt.js";import{o as E,e as F,d as A,f as C,A as m,l as G,a as N}from"./index-fPzgLVil.js";import{f as U}from"./formatters-DBeaC9UC.js";import{S as Y,I as j,E as K,d as M}from"./BaseContext-CH9A7-TB.js";import{n as q}from"./navigation-B-mN4luC.js";import{Y as W}from"./YesNoButton-W51do83Q.js";import{P as $}from"./ColumnRenderers-6jyK6a0i.js";import{S as O}from"./Instance-DrUTN1gu.js";import{E as g}from"./GenericErrorPage-BDqvbBMU.js";import R from"./NotFound-Dr2EC1Qm.js";import{P as h}from"./PermissionDenied-BHX44oqK.js";function k({pk:e,type:r}){const{data:t}=T({queryKey:["badge",r,e],queryFn:async()=>{let n="";switch(r){case"owner":n=m.owner_list;break;case"user":n=m.user_list;break;case"group":n=m.group_list;break;default:return{}}const l=F(n,e);return A.get(l).then(o=>{switch(o.status){case 200:return o.data;default:return{}}}).catch(()=>({}))}}),i=G();if(!t||t.isLoading||t.isFetching)return a.jsx(B,{height:12,radius:"md"});function s(){return!t||!t.pk?"":r==="user"&&i.isSet("DISPLAY_FULL_NAMES")?t.first_name||t.last_name?`${t.first_name} ${t.last_name}`:t.username:r==="user"?t.username:t.name}return a.jsxs(_,{wrap:"nowrap",gap:"sm",justify:"right",children:[a.jsx(L,{color:"dark",variant:"filled",style:{display:"flex",alignItems:"center"},children:(t==null?void 0:t.name)??s()}),a.jsx(j,{icon:r==="user"?r:t.label})]})}function J(e){var r;return a.jsx(u,{size:"sm",children:U((r=e.field_value)==null?void 0:r.toString())})}function Q(e){var i,s,n;const r=e==null?void 0:e.field_value;let t=null;return(i=e.field_data)!=null&&i.badge?a.jsx(k,{pk:r,type:e.field_data.badge}):((s=e==null?void 0:e.field_data)!=null&&s.value_formatter?t=e.field_data.value_formatter():r==null?t=a.jsx(u,{size:"sm",children:"'---'"}):t=a.jsx(u,{size:"sm",children:r.toString()}),a.jsxs(_,{wrap:"nowrap",gap:"xs",justify:"space-apart",children:[a.jsxs(_,{wrap:"nowrap",gap:"xs",justify:"left",children:[t,e.field_data.unit&&a.jsx(u,{size:"xs",children:e.unit})]}),e.field_data.user&&a.jsx(k,{pk:(n=e.field_data)==null?void 0:n.user,type:"user"})]}))}function H(e){return a.jsx(W,{value:e.field_value})}function X(e){var o,v;const r=M(),{data:t}=T({queryKey:["detail",e.field_data.model,e.field_value],queryFn:async()=>{var y;if(!((y=e.field_data)!=null&&y.model))return{};const d=E(e.field_data.model);if(!(d!=null&&d.api_endpoint))return{};const V=F(d.api_endpoint,e.field_value);return A.get(V,{params:e.field_data.model_filters??void 0}).then(b=>{switch(b.status){case 200:return b.data;default:return{}}}).catch(()=>({}))}}),i=x.useMemo(()=>{var d;return((d=e==null?void 0:e.field_data)==null?void 0:d.model)&&C(e.field_data.model,e.field_value)},[e.field_data.model,e.field_value]),s=x.useCallback(d=>{q(i,r,d)},[i]);if(!t||t.isLoading||t.isFetching)return a.jsx(B,{height:12,radius:"md"});if(e.field_data.external)return a.jsx(S,{href:`${e.field_value}`,target:"_blank",rel:"noreferrer noopener",children:a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px"},children:[a.jsx(u,{children:e.field_value}),a.jsx(j,{icon:"external",iconProps:{size:15}})]})});let n=((o=e.field_data)==null?void 0:o.link)??!0,l;return e.field_data.model_formatter?l=e.field_data.model_formatter(t)??l:e.field_data.model_field?l=(t==null?void 0:t[e.field_data.model_field])??l:l=t==null?void 0:t.name,l===void 0&&(l=(t==null?void 0:t.name)??((v=e.field_data)==null?void 0:v.backup_value)??f._({id:"ATGKLv"}),n=!1),a.jsx(a.Fragment,{children:n?a.jsx(S,{href:"#",onClick:s,children:a.jsx(u,{children:l})}):a.jsx(u,{children:l})})}function Z(e){return e.field_data.total<=0?a.jsx(u,{size:"sm",children:e.field_data.progress}):a.jsx($,{value:e.field_data.progress,maximum:e.field_data.total,progressLabel:!0})}function p(e){return a.jsx(O,{type:e.field_data.model,status:e.field_value})}function ee({value:e}){return a.jsx(K,{value:e})}function ae({item:e,field:r}){function t(n){switch(n){case"boolean":return H;case"link":return X;case"progressbar":return Z;case"status":return p;case"date":return J;case"text":case"string":default:return Q}}const i=t(r.type),s=x.useMemo(()=>z(e,r.name),[e,r.name]);return a.jsxs(c.Tr,{style:{verticalAlign:"top"},children:[a.jsx(c.Td,{style:{width:"50",maxWidth:"50"},children:a.jsx(j,{icon:r.icon??r.name})}),a.jsx(c.Td,{style:{maxWidth:"65%",lineBreak:"auto"},children:a.jsx(u,{children:r.label})}),a.jsx(c.Td,{style:{lineBreak:"anywhere"},children:a.jsx(i,{field_data:r,field_value:s})}),a.jsx(c.Td,{style:{width:"50"},children:r.copy&&a.jsx(ee,{value:s})})]})}function je({item:e,fields:r,title:t}){return a.jsx(w,{p:"xs",withBorder:!0,radius:"xs",children:a.jsxs(I,{gap:"xs",children:[t&&a.jsx(Y,{size:"lg",children:t}),a.jsx(c,{striped:!0,verticalSpacing:5,horizontalSpacing:"sm",children:a.jsx(c.Tbody,{children:r.filter(i=>!i.hidden).map((i,s)=>a.jsx(ae,{field:i,item:e},s))})})]})})}function ge(e){return a.jsx(w,{p:"xs",children:a.jsx(D,{cols:2,spacing:"xs",verticalSpacing:"xs",children:e.children})})}function te(){return a.jsx(g,{title:f._({id:"vYV5VB"}),message:f._({id:"5a3xiK"})})}function re({status:e}){switch(e){case 401:return a.jsx(te,{});case 403:return a.jsx(h,{});case 404:return a.jsx(R,{})}return a.jsx(g,{title:f._({id:"AOPUbq"}),message:f._({id:"yuzYd9"}),status:e})}function ie({status:e}){return a.jsx(g,{title:f._({id:"iSWuCp"}),message:f._({id:"vB3crB"}),status:e})}function ve({status:e,loading:r,children:t,requiredRole:i,requiredPermission:s}){const n=N();return r||!n.isLoggedIn()?a.jsx(P,{}):e>=500?a.jsx(ie,{status:e}):e>=400?a.jsx(re,{status:e}):i&&!n.hasViewRole(i)?a.jsx(h,{}):s&&!n.hasViewPermission(s)?a.jsx(h,{}):a.jsx(a.Fragment,{children:t})}export{je as D,ge as I,ve as a};
