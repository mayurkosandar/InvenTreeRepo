import{r as c,i as e,j as a,dz as ee,aP as te,dA as ie,a0 as se,b1 as ae,b5 as ne,bA as le,ce as I,bD as P,S as oe,cq as L,m as f,G as H,dB as re,ci as de}from"./vendor-BnaqX2_l.js";import{u as W,b as ce,S as ue,c as B,T as Y,A as _e}from"./UseForm-DwZIxEnj.js";import{A as pe}from"./ActionDropdown-D1A3arjv.js";import{O as fe}from"./OrderPartsWizard-BFgDSSVd.js";import{b as me,c as he}from"./formatters-DBeaC9UC.js";import{l as O,m as v,e as G,A as x,d as K,a as be,U as F}from"./index-fPzgLVil.js";import{R as ge}from"./RemoveRowButton-Dm_wD7jw.js";import{T as Z,S as ke}from"./Instance-DrUTN1gu.js";import{I as k,F as xe,S as je}from"./BaseContext-CH9A7-TB.js";import{u as Se,a as ye}from"./UseGenerator-DOw_SLei.js";import{u as ve}from"./UsePlaceholder-Dc_Ugorx.js";import{S as $,u as Ce,I as Te}from"./InvenTreeTable-rEa-i3pt.js";import{a as Fe,D as ze,f as Pe,S as Re,h as Ae,i as Q}from"./ColumnRenderers-6jyK6a0i.js";function Me({partId:t,stockItem:l,create:i=!1}){const s=O(),[n,d]=c.useState({}),[o,u]=c.useState(null),[r,h]=c.useState(""),[b,p]=c.useState(""),S=Se(m=>{h(m?`${e._({id:"iAY2dt"})}: ${m}`:"")}),g=ye(m=>{p(m?`${e._({id:"TVYdHj"})}: ${m}`:"")});return c.useEffect(()=>{n!=null&&n.pk&&(S.update({part:n.pk}),g.update({part:n.pk}))},[n.pk]),c.useMemo(()=>({part:{value:n.pk,disabled:!i,filters:{active:i?!0:void 0},onValueChange:(_,z)=>{d(z),u(null)}},supplier_part:{hidden:(n==null?void 0:n.purchaseable)==!1,value:o,onValueChange:_=>{u(_)},filters:{part_detail:!0,supplier_detail:!0,part:t},adjustFilters:_=>(_.data.part&&(_.filters.part=_.data.part),_.filters)},use_pack_size:{hidden:!i,description:e._({id:"qyS7x9"})},location:{hidden:!i,onValueChange:_=>{S.update({location:_})},filters:{structural:!1}},quantity:{hidden:!i,description:e._({id:"LWFE8j"}),onValueChange:_=>{S.update({quantity:_})}},serial_numbers:{field_type:"string",label:e._({id:"VzQT2x"}),disabled:(n==null?void 0:n.trackable)==!1,description:e._({id:"0dR85g"}),required:!1,hidden:!i,placeholder:b},serial:{hidden:i||n.trackable==!1||(l==null?void 0:l.quantity)!=null&&(l==null?void 0:l.quantity)!=1},batch:{placeholder:r},status_custom_key:{label:e._({id:"Y3/0dR"})},expiry_date:{icon:a.jsx(ee,{}),hidden:!s.isSet("STOCK_ENABLE_EXPIRY")},purchase_price:{icon:a.jsx(te,{})},purchase_price_currency:{icon:a.jsx(ie,{})},packaging:{icon:a.jsx(se,{})},link:{icon:a.jsx(ae,{})},owner:{icon:a.jsx(ne,{})},delete_on_deplete:{}}),[l,n,t,s,o,b,r,i])}function _t(){return c.useMemo(()=>({location:{filters:{structural:!1}},note:{}}),[])}function pt({stockItem:t}){const l=O(),[i,s]=c.useState(null);return c.useEffect(()=>{s(null)},[t]),c.useMemo(()=>({part:{field_type:"related field",required:!0,exclude:!0,label:e._({id:"vgP+9p"}),description:e._({id:"B+pzHp"}),model:v.part,api_url:G(x.part_list),onValueChange:n=>{s(n)},filters:{trackable:!0,in_bom_for:l.isSet("STOCK_ENFORCE_BOM_INSTALLATION")?t.part:void 0}},stock_item:{disabled:!i,filters:{part_detail:!0,in_stock:!0,available:!0,tracked:!0,part:i||void 0}},quantity:{},note:{}}),[l,i,t])}function ft({partId:t,trackable:l}){const i=ve({partId:t,key:"stock-item-serialize",enabled:l});return c.useMemo(()=>({quantity:{},serial_numbers:{placeholder:i},destination:{}}),[i])}function Ee({stockItem:t,value:l}){var s,n;const{data:i}=re({queryKey:["location",((s=t.part_detail)==null?void 0:s.default_location)??((n=t.part_detail)==null?void 0:n.category_default_location)],queryFn:async()=>{var o,u;const d=G(x.stock_location_list,((o=t.part_detail)==null?void 0:o.default_location)??((u=t.part_detail)==null?void 0:u.category_default_location));return K.get(d).then(r=>{switch(r.status){case 200:return r.data;default:return null}}).catch(()=>null)}});return a.jsxs(L,{gap:"sm",justify:"space-evenly",align:"center",children:[a.jsxs(L,{gap:"sm",direction:"column",align:"center",children:[a.jsxs(f,{children:[l," x ",t.part_detail.name]}),a.jsx(Z,{src:t.part_detail.thumbnail,size:80,align:"center"})]}),a.jsxs(L,{direction:"column",gap:"sm",align:"center",children:[a.jsx(f,{children:t.location_detail.pathstring}),a.jsx(k,{icon:"arrow_down"}),a.jsx(c.Suspense,{fallback:a.jsx(de,{width:"150px"}),children:a.jsx(f,{children:i==null?void 0:i.pathstring})})]})]})}function qe(t,l,i){xe.openConfirmModal({title:a.jsx(je,{children:e._({id:"AEaskR"})}),children:a.jsx(Ee,{stockItem:t,value:l}),onConfirm:()=>{var s,n,d,o;t.location===((s=t.part_detail)==null?void 0:s.default_location)||t.location===((n=t.part_detail)==null?void 0:n.category_default_location)||K.post(G(x.stock_transfer),{items:[{pk:t.pk,quantity:l,batch:t.batch,status:t.status}],location:((d=t.part_detail)==null?void 0:d.default_location)??((o=t.part_detail)==null?void 0:o.category_default_location)}).then(u=>(i(),u.data)).catch(()=>null)}})}function C({props:t,transfer:l=!1,changeStatus:i=!1,add:s=!1,setMax:n=!1,merge:d=!1,record:o}){var R,A,M,E,q,D,w,J,N,y;const u=c.useMemo(()=>{var j;return((j=$(v.stockitem)())==null?void 0:j.map(U=>({value:U.value,display_name:U.label})))??[]},[]),[r,h]=c.useState(s?0:((R=t.item)==null?void 0:R.quantity)??0),[b,p]=c.useState(void 0),S=()=>{t.removeFn(t.idx)},[g,m]=I(!1,{onOpen:()=>{l&&t.changeFn(t.idx,"packaging",(o==null?void 0:o.packaging)||void 0)},onClose:()=>{l&&t.changeFn(t.idx,"packaging",void 0)}}),[_,z]=I(!1,{onOpen:()=>{p((o==null?void 0:o.status_custom_key)||(o==null?void 0:o.status)||void 0),t.changeFn(t.idx,"status",(o==null?void 0:o.status)||void 0)},onClose:()=>{p(void 0),t.changeFn(t.idx,"status",void 0)}}),V=c.useMemo(()=>o?o.serial?`#${o.serial}`:`${o.quantity}`:"-",[o]);return o?a.jsxs(a.Fragment,{children:[a.jsxs(P.Tr,{children:[a.jsx(P.Td,{children:a.jsxs(oe,{gap:"xs",children:[a.jsxs(L,{gap:"sm",align:"center",children:[a.jsx(Z,{size:40,src:(A=o.part_detail)==null?void 0:A.thumbnail,align:"center"}),a.jsx("div",{children:(M=o.part_detail)==null?void 0:M.name})]}),((q=(E=t.rowErrors)==null?void 0:E.pk)==null?void 0:q.message)&&a.jsx(f,{c:"red",size:"xs",children:t.rowErrors.pk.message})]})}),a.jsx(P.Td,{children:o.location?(D=o.location_detail)==null?void 0:D.pathstring:"-"}),a.jsx(P.Td,{children:a.jsxs(H,{grow:!0,justify:"space-between",wrap:"nowrap",children:[a.jsx(f,{children:V}),a.jsx(ke,{status:o.status_custom_key,type:v.stockitem})]})}),!d&&a.jsx(P.Td,{children:a.jsx(ue,{fieldName:"quantity",fieldDefinition:{field_type:"number",value:r,onValueChange:j=>{h(j),t.changeFn(t.idx,"quantity",j)}},error:(J=(w=t.rowErrors)==null?void 0:w.quantity)==null?void 0:J.message})}),a.jsx(P.Td,{children:a.jsxs(L,{gap:"3px",children:[l&&a.jsx(B,{onClick:()=>qe(o,t.item.quantity,S),icon:a.jsx(k,{icon:"default_location"}),tooltip:e._({id:"b+SPUR"}),tooltipAlignment:"top",disabled:!((N=o.part_detail)!=null&&N.default_location)&&!((y=o.part_detail)!=null&&y.category_default_location)}),i&&a.jsx(B,{size:"sm",icon:a.jsx(k,{icon:"status"}),tooltip:e._({id:"Gt4cm5"}),onClick:()=>z.toggle(),variant:_?"filled":"transparent"}),l&&a.jsx(B,{size:"sm",icon:a.jsx(k,{icon:"packaging"}),tooltip:e._({id:"O7MZ1G"}),onClick:()=>m.toggle(),variant:g?"filled":"transparent"}),a.jsx(ge,{onClick:()=>t.removeFn(t.idx)})]})})]}),i&&a.jsx(Y,{visible:_,onValueChange:j=>{p(j),t.changeFn(t.idx,"status",j||void 0)},fieldName:"status",fieldDefinition:{field_type:"choice",label:e._({id:"uAQUqI"}),choices:u,value:b},defaultValue:b}),l&&a.jsx(Y,{visible:l&&g,onValueChange:j=>{t.changeFn(t.idx,"packaging",j||void 0)},fieldName:"packaging",fieldDefinition:{field_type:"string",label:e._({id:"pD/Ew0"})},defaultValue:o.packaging})]}):a.jsx("div",{children:e._({id:"Z3FXyt"})})}function X(t){return t.map(i=>({pk:i.pk,quantity:i.quantity,batch:i.batch||void 0,status:i.status||void 0,packaging:i.packaging||void 0,obj:i}))}function De(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(C,{props:s,transfer:!0,changeStatus:!0,setMax:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"blbbPS"}),e._({id:"QWdKwH"}),e._({id:"7L01XJ"})]},location:{filters:{structural:!1}},notes:{}}}function we(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(C,{props:s,setMax:!0,changeStatus:!0,add:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"t/YqKh"}),e._({id:"7L01XJ"})]},notes:{}}}function Le(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(C,{changeStatus:!0,props:s,add:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"m16xKo"}),e._({id:"7L01XJ"})]},notes:{}}}function Oe(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>a.jsx(C,{props:s,changeStatus:!0,record:l[s.item.pk]},s.item.pk),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"wBMjJ2"}),e._({id:"7L01XJ"})]},notes:{}}}function Ge(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>s.pk),modelRenderer:s=>a.jsx(C,{props:s,merge:!0,record:l[s.item]},s.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},status:{},note:{}}}function Ve(t){var s;if(!t)return{};const l=Object.fromEntries(t.map(n=>[n.pk,n]));return{items:{field_type:"table",value:t.map(n=>({item:n.pk,obj:n})),modelRenderer:n=>a.jsx(C,{props:n,merge:!0,changeStatus:!0,record:l[n.item.item]},n.item.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},location:{default:(s=t[0])==null?void 0:s.part_detail.default_location,filters:{structural:!1}},notes:{},allow_mismatched_suppliers:{},allow_mismatched_status:{}}}function Je(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>({item:s.pk,obj:s})),modelRenderer:s=>a.jsx(C,{props:s,merge:!0,record:l[s.item.item]},s.item.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},customer:{filters:{is_customer:!0}},notes:{}}}function Ne(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>s.pk),modelRenderer:s=>{const n=l[s.item];return a.jsx(C,{props:s,merge:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]}}}function T({items:t,pk:l,model:i,refresh:s,fieldGenerator:n,endpoint:d,filters:o,title:u,successMessage:r,modalFunc:h=W}){const b={part_detail:!0,location_detail:!0,cascade:!1},p=c.useMemo(()=>{const m={...b,...o??{}};return m[i]=l===void 0&&i==="location"?"null":l,m},[b,o,i,l]),{data:S}=le({queryKey:["stockitems",i,l,t,p],queryFn:async()=>{if(t)return Array.isArray(t)?t:[t];const m=G(x.stock_item_list);return K.get(m,{params:p}).then(_=>{if(_.status===200)return _.data}).catch(()=>null)}}),g=c.useMemo(()=>n(S),[S]);return h({url:d,fields:g,title:u,size:"80%",successMessage:r,onFormSuccess:()=>s()})}function Ue(t){return T({...t,fieldGenerator:Le,endpoint:x.stock_add,title:e._({id:"smUxso"}),successMessage:e._({id:"2kGS2K"})})}function Xe(t){return T({...t,fieldGenerator:we,endpoint:x.stock_remove,title:e._({id:"dxvf6V"}),successMessage:e._({id:"uMaw0F"})})}function Be(t){return T({...t,fieldGenerator:De,endpoint:x.stock_transfer,title:e._({id:"9efe+k"}),successMessage:e._({id:"02r6MH"})})}function Qe(t){return T({...t,fieldGenerator:Oe,endpoint:x.stock_count,title:e._({id:"n/p2QJ"}),successMessage:e._({id:"iEFfQA"})})}function Ke(t){return T({...t,fieldGenerator:Ge,endpoint:x.stock_change_status,title:e._({id:"Y+vtBl"}),successMessage:e._({id:"dbA8fL"})})}function Ie(t){return T({...t,fieldGenerator:Ve,endpoint:x.stock_merge,title:e._({id:"z5kN6j"}),successMessage:e._({id:"BSKV/s"})})}function Ye(t){const l=c.useMemo(()=>{var i;return(i=t.items)==null?void 0:i.filter(s=>{var n;return(n=s==null?void 0:s.part_detail)==null?void 0:n.salable})},[t.items]);return T({...t,items:l,fieldGenerator:Je,endpoint:x.stock_assign,title:e._({id:"i2FExn"}),successMessage:e._({id:"zTh3Rb"})})}function He(t){return T({...t,fieldGenerator:Ne,endpoint:x.stock_item_list,modalFunc:ce,title:e._({id:"khKVoc"}),successMessage:e._({id:"9Y/rsA"})})}function mt(){return{parent:{description:e._({id:"9P2CtI"}),required:!1},name:{},description:{},structural:{},external:{},custom_icon:{field_type:"icon"},location_type:{}}}function ht({partId:t,itemId:l,templateId:i,editing:s=!1,editTemplate:n=!1}){const[d,o]=c.useState([]),[u,r]=c.useState("string"),h=O(),b=c.useMemo(()=>h.isSet("TEST_STATION_DATA"),[h]);return c.useMemo(()=>{const p={stock_item:{value:l,hidden:!0},template:{disabled:!n&&!!i,filters:{include_inherited:!0,part:t},onValueChange:(S,g)=>{if(g!=null&&g.choices){const m=g.choices.split(",");m.length>0?(o(m.map(_=>({label:_.trim(),value:_.trim()}))),r("choice")):(o([]),r("string"))}}},result:{},value:{field_type:u,choices:u==="choice"?d:void 0},attachment:{},notes:{},started_datetime:{hidden:!b},finished_datetime:{hidden:!b},test_station:{hidden:!b}};return s&&delete p.attachment,p},[d,s,n,u,t,l,i,b])}function We({showLocation:t,showPricing:l}){return[{accessor:"part",sortable:!0,render:i=>Fe({part:i==null?void 0:i.part_detail})},{accessor:"part_detail.IPN",title:e._({id:"3wXEsN"}),sortable:!0},{accessor:"part_detail.revision",title:e._({id:"6LTyxl"}),sortable:!0},ze({accessor:"part_detail.description"}),{accessor:"quantity",ordering:"stock",sortable:!0,title:e._({id:"blbbPS"}),render:i=>{const s=(i==null?void 0:i.quantity)??0,n=(i==null?void 0:i.allocated)??0,d=s-n;let o=s;const u=(i==null?void 0:i.part_detail)??{},r=[];let h;return i.serial&&s==1&&(o=`# ${i.serial}`),i.is_building?(h="blue",r.push(a.jsx(f,{size:"sm",children:e._({id:"fh2Vf5"})},"production"))):i.sales_order?r.push(a.jsx(f,{size:"sm",children:e._({id:"X1BIR/"})},"sales-order")):i.customer?r.push(a.jsx(f,{size:"sm",children:e._({id:"fHlvYo"})},"customer")):i.belongs_to?r.push(a.jsx(f,{size:"sm",children:e._({id:"bGwMIh"})},"belongs-to")):i.consumed_by?r.push(a.jsx(f,{size:"sm",children:e._({id:"Xig/cj"})},"consumed-by")):i.in_stock||r.push(a.jsx(f,{size:"sm",children:e._({id:"szsXHP"})},"unavailable")),i.expired?r.push(a.jsx(f,{size:"sm",children:e._({id:"x/QIhZ"})},"expired")):i.stale&&r.push(a.jsx(f,{size:"sm",children:e._({id:"UtuqjX"})},"stale")),i.in_stock&&(n>0&&(n>=s?(h="orange",r.push(a.jsx(f,{size:"sm",children:e._({id:"L1D5PL"})},"fully-allocated"))):r.push(a.jsx(f,{size:"sm",children:e._({id:"PjVOCj"})},"partially-allocated"))),d!=s&&(d>0?r.push(a.jsx(f,{size:"sm",c:"orange",children:`${e._({id:"csDS2L"})}: ${d}`},"available")):r.push(a.jsx(f,{size:"sm",c:"red",children:e._({id:"a5n/wL"})},"no-stock"))),s<=0&&r.push(a.jsx(f,{size:"sm",children:e._({id:"ddPzUj"})},"depleted"))),i.in_stock||(h="red"),a.jsx(Pe,{value:a.jsxs(H,{gap:"xs",justify:"left",wrap:"nowrap",children:[a.jsx(f,{c:h,children:o}),u.units&&a.jsxs(f,{size:"xs",c:h,children:["[",u.units,"]"]})]}),title:e._({id:"odasNw"}),extra:r})}},Re({model:v.stockitem}),{accessor:"batch",sortable:!0},Ae({hidden:!t,accessor:"location_detail"}),{accessor:"purchase_order",title:e._({id:"KxySMG"}),render:i=>i.purchase_order_reference},{accessor:"SKU",title:e._({id:"nne72x"}),sortable:!0},{accessor:"MPN",title:e._({id:"bisS0I"}),sortable:!0},{accessor:"purchase_price",title:e._({id:"vWelsN"}),sortable:!0,switchable:!0,hidden:!l,render:i=>me(i.purchase_price,{currency:i.purchase_price_currency})},{accessor:"stock_value",title:e._({id:"g9RfVq"}),sortable:!1,hidden:!l,render:i=>{var o,u;const s=i.purchase_price||((o=i.part_detail)==null?void 0:o.pricing_min),n=i.purchase_price||((u=i.part_detail)==null?void 0:u.pricing_max),d=i.purchase_price_currency||void 0;return he(s,n,{currency:d,multiplier:i.quantity})}},{accessor:"packaging",sortable:!0},Q({title:e._({id:"uaSvqt"}),accessor:"expiry_date",hidden:!O.getState().isSet("STOCK_ENABLE_EXPIRY")}),Q({title:e._({id:"K7P0jz"}),accessor:"updated"}),Q({accessor:"stocktake_date",title:e._({id:"6OScNP"}),sortable:!0})]}function Ze({enableExpiry:t}){return[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"UjHL/d"})},{name:"status",label:e._({id:"uAQUqI"}),description:e._({id:"+Jr1e4"}),choiceFunction:$(v.stockitem)},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"3Ah+L7"})},{name:"allocated",label:e._({id:"A/ybx7"}),description:e._({id:"pxiNcZ"})},{name:"available",label:e._({id:"csDS2L"}),description:e._({id:"kbUAFH"})},{name:"cascade",label:e._({id:"VY386J"}),description:e._({id:"fMbOmV"})},{name:"depleted",label:e._({id:"9/P0N3"}),description:e._({id:"0n9TfP"})},{name:"in_stock",label:e._({id:"zn38D/"}),description:e._({id:"oXdFGe"})},{name:"is_building",label:e._({id:"BE5Q6v"}),description:e._({id:"c64azd"})},{name:"include_variants",label:e._({id:"/g9i/Z"}),description:e._({id:"n9gDGi"})},{name:"consumed",label:e._({id:"XNITBt"}),description:e._({id:"1yWWZV"})},{name:"installed",label:e._({id:"eQkgKV"}),description:e._({id:"GQ73kf"})},{name:"sent_to_customer",label:e._({id:"XwjZor"}),description:e._({id:"LPuYfz"})},{name:"serialized",label:e._({id:"SkCY/+"}),description:e._({id:"S5yS1f"})},{name:"batch",label:e._({id:"Vea6Aj"}),description:e._({id:"Y/SfF6"}),type:"text"},{name:"serial",label:e._({id:"AXeJt4"}),description:e._({id:"hFRTeN"}),type:"text"},{name:"serial_lte",label:e._({id:"HnbC6h"}),description:e._({id:"yLzTzA"}),type:"text"},{name:"serial_gte",label:e._({id:"CSpSNh"}),description:e._({id:"Gnj5CL"}),type:"text"},{name:"has_batch",label:e._({id:"qPCbMt"}),description:e._({id:"rc/Y1E"})},{name:"tracked",label:e._({id:"EaG6cP"}),description:e._({id:"TRFyJq"})},{name:"has_purchase_price",label:e._({id:"+MprDT"}),description:e._({id:"tAFrkr"})},{name:"expired",label:e._({id:"M1RnFv"}),description:e._({id:"JiHUig"}),active:t},{name:"stale",label:e._({id:"1ba70W"}),description:e._({id:"SQjqoc"}),active:t},{name:"expiry_before",label:e._({id:"mHDi5V"}),description:e._({id:"j2+SIa"}),type:"date",active:t},{name:"expiry_after",label:e._({id:"snknx0"}),description:e._({id:"UyBcoZ"}),type:"date",active:t},{name:"updated_before",label:e._({id:"h8xl5M"}),description:e._({id:"5zwJta"}),type:"date"},{name:"updated_after",label:e._({id:"nl9mSR"}),description:e._({id:"P5Y0sz"}),type:"date"},{name:"stocktake_before",label:e._({id:"Hj/Grl"}),description:e._({id:"iTehcJ"}),type:"date"},{name:"stocktake_after",label:e._({id:"+GUu77"}),description:e._({id:"w30K80"}),type:"date"},{name:"external",label:e._({id:"k7rbV9"}),description:e._({id:"ETtRZU"})}]}function bt({params:t={},allowAdd:l=!1,showLocation:i=!0,showPricing:s=!0,tableName:n="stockitems"}){const d=Ce(n),o=be(),u=O(),r=c.useMemo(()=>u.isSet("STOCK_ENABLE_EXPIRY"),[u]),h=c.useMemo(()=>We({showLocation:i??!0,showPricing:s??!0}),[i,s]),b=c.useMemo(()=>Ze({enableExpiry:r}),[r]),p=c.useMemo(()=>({items:d.selectedRecords,model:v.stockitem,refresh:d.refreshTable,filters:{in_stock:!0}}),[d]),S=Me({create:!0,partId:t.part}),g=W({url:x.stock_item_list,title:e._({id:"bJLEQT"}),fields:S,initialData:{part:t.part,location:t.location},follow:!0,modelType:v.stockitem}),[m,_]=c.useState([]),z=fe({parts:m}),V=Be(p),R=Ue(p),A=Xe(p),M=Qe(p),E=Ke(p),q=Ie(p),D=Ye(p),w=He(p),J=c.useMemo(()=>{const N=o.hasDeleteRole(F.stock),y=o.hasAddRole(F.stock),j=o.hasAddRole(F.stocktake);return o.hasAddRole(F.purchase_order),o.hasChangeRole(F.purchase_order),[a.jsx(pe,{tooltip:e._({id:"bbA1t1"}),icon:a.jsx(k,{icon:"stock"}),disabled:d.selectedRecords.length===0,actions:[{name:e._({id:"n/p2QJ"}),icon:a.jsx(k,{icon:"stocktake",iconProps:{color:"blue"}}),tooltip:e._({id:"n/p2QJ"}),disabled:!j,onClick:()=>{M.open()}},{name:e._({id:"smUxso"}),icon:a.jsx(k,{icon:"add",iconProps:{color:"green"}}),tooltip:e._({id:"wiTIgC"}),disabled:!y,onClick:()=>{R.open()}},{name:e._({id:"dxvf6V"}),icon:a.jsx(k,{icon:"remove",iconProps:{color:"red"}}),tooltip:e._({id:"vP4ilC"}),disabled:!y,onClick:()=>{A.open()}},{name:e._({id:"9efe+k"}),icon:a.jsx(k,{icon:"transfer",iconProps:{color:"blue"}}),tooltip:e._({id:"lgwXs+"}),disabled:!y,onClick:()=>{V.open()}},{name:e._({id:"E6cz5z"}),icon:a.jsx(k,{icon:"info",iconProps:{color:"blue"}}),tooltip:e._({id:"/gndGd"}),disabled:!y,onClick:()=>{E.open()}},{name:e._({id:"3iu3Xl"}),icon:a.jsx(k,{icon:"merge"}),tooltip:e._({id:"V22osk"}),disabled:!y,onClick:()=>{q.open()}},{name:e._({id:"G4SnGh"}),icon:a.jsx(k,{icon:"buy"}),tooltip:e._({id:"iihIqf"}),hidden:!o.hasAddRole(F.purchase_order),disabled:!d.hasSelectedRecords,onClick:()=>{_(d.selectedRecords.map(U=>U.part_detail)),z.openWizard()}},{name:e._({id:"chR2IB"}),icon:a.jsx(k,{icon:"customer"}),tooltip:e._({id:"jETzQV"}),disabled:!y,onClick:()=>{D.open()}},{name:e._({id:"6vqSiF"}),icon:a.jsx(k,{icon:"delete",iconProps:{color:"red"}}),tooltip:e._({id:"khKVoc"}),disabled:!N,onClick:()=>{w.open()}}]},"stock-actions"),a.jsx(_e,{hidden:!l||!o.hasAddRole(F.stock),tooltip:e._({id:"bJLEQT"}),onClick:()=>g.open()},"add-stock-item")]},[o,l,d.hasSelectedRecords,d.selectedRecords]);return a.jsxs(a.Fragment,{children:[g.modal,V.modal,A.modal,R.modal,M.modal,E.modal,q.modal,D.modal,w.modal,z.wizard,a.jsx(Te,{url:G(x.stock_item_list),tableState:d,columns:h,props:{enableDownload:!0,enableSelection:!0,enableLabels:!0,enableReports:!0,tableFilters:b,tableActions:J,modelType:v.stockitem,params:{...t,part_detail:!0,location_detail:!0,supplier_part_detail:!0}}})]})}export{bt as S,Be as a,pt as b,_t as c,ht as d,Me as e,Ue as f,Xe as g,Ye as h,ft as i,mt as s,Qe as u};
